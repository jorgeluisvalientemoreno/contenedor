select *
from open.LDC_LOGERRLEORRESU r, open.or_order_Activity a
where (proceso like '%PRJOBRECOYSUSPRP%' or proceso like '%PRGENRECORP%')
--And   fechgene >= '21/05/2020'
and r.order_id=a.order_id
--and r.order_id=1705446
and a.product_id in (1705446);

select *
from open.LOG_ERRORES_CAMBIO_TISU r, open.or_order_Activity a
where (proceso like '%PRJOBRECOYSUSPRP%' or proceso like '%PRGENRECORP%')
And   fechgene >= '15/03/2021'
and r.order_id=a.order_id
and a.product_id in (1705446);




 select *
 from  open.mo_motive m,  open.mo_packages s,  open.LDC_PRODRERP p
 where product_id = p.PRREPROD
  and m.package_id = s.package_id
  and s.PACKAGE_TYPE_ID = 100312
  and s.motive_status_id not in (36,13)


select c.*, sysdate
from open.ldc_osf_estaproc c
where proceso = 'PRJOBRECOYSUSPRP' and FECHA_INICIAL_EJEC > sysdate - 1;

SELECT *
FROM 
WHERE F.PRREfege>='26/11/2021'
 and prreproc='S'
 and exists(select null from servsusc s where sesunuse=f.prreprod and sesucicl in (301,1210,1236,1301,1327,1399,1501,4102,4204,4304,4402,4502,4616,4716,4802,4902,5005,5202,5302,5393,5491,7214,7414,8714))
 and prreobse!='PROCESADO CON EXITO'
;


select *
from
(
SELECT *
FROM OPEN.LDC_PRODRERP f
WHERE f.prrefepr>='18/06/2021'
UNION
SELECT *
FROM OPEN.LDC_PRODRERP f
WHERE F.PRREOBSE='X'

)
order by 6
;

select prreobse, count(1)
from
(
SELECT f.prreprod, f.prreacti, f.prrefege, f.prreproc, f.prrefepr,
       case when  f.prreobse like '%El registro Personal de la Unidad de Trabajo % no existe%' then 'El registro Personal de la Unidad de Trabajo no existe, o no esta autorizado para acceder los datos. '
        when f.prreobse like '%El ciclo de consumo % no tiene un periodo de consumo vigente%' then 'El ciclo de consumo no tiene un periodo de consumo vigente'
          when f.prreobse like '%La fecha actual no se encuentra en los periodos de facturacion del ciclo%' then 'La fecha actual no se encuentra en los periodos de facturacion del ciclo'
          when f.prreobse like '%La fecha actual no se encuentra dentro del periodo de facturacion actual del ciclo%' then 'La fecha actual no se encuentra dentro del periodo de facturacion actual'
       else f.prreobse end prreobse

FROM OPEN.LDC_PRODRERP f
WHERE F.PRREPROC='S'
and f.prrefepr>='18/06/2021'
UNION
SELECT *
FROM OPEN.LDC_PRODRERP f
WHERE F.PRREOBSE='X'
)
group by prreobse
;

select *
from open.LDC_PRVACASU r
where r.prcanuse in (17100054,6119157,50287557,1176462,50060183,2069187,50003526,17091989,17033286,6104792,2069957,2084416,2071399,6624474,6131865,50021689,17152861,17022044,17173170,2087094,14522738,50126616,1061335,2070145,50052877,50308031,6123366,1190845,17200527,5061489,50035574,50322436,50336272,2082924,6122858,1138522,50188096,17107259,4068049,4068141,17099554,17109522,17232090,17021382,50075594,1099258,2072502,1127785,50085180,6111839,50782310,1063302,50082811,2087975,2040151,1063749,2067545,6524123,50039160,6636592,5058810,4060094,2067909,1188943,50317967,50763833,17034841,17162688,17108668,17023524,4068042,50327179,50020936,6098918,17137188,50057134,4068789,5059464,2069803,50117750,50540682,1138791,2084603,50104105,17025181,14502068,17218585,17010313,50095004,1999582,36000089,50787736,1130415,4064290,17028081,50024156,50040744,17181852,17099446,50277873,1096362,17151774,1058446,17189239,6536603,17215182,4056010,50035849,1999577,17042930,17031546,17037709,2086667,1052098,2080046,6515138,6534102,8090949,8090090,50018664,1069248,50075483,50745271,2059851,2090622,1171669,17189229,2072889,50057865,2066863,50514106,6567106,50002109,17044485,2060681,50500685,17018623,50329894,50311290,17013802,1000530,1098180,50682202,6523090,6122277,50076988,2076096,50085367,2085815,50074642,5061569,6106322,50325532,1146287,2072933,1999595,1180565,8091560,50203764,17192988,17043223,2086870,2068497,50024155,50075252,2058317,17012745,17182952,2091941,2017955,50014310,1152549,5056288,2074613,50024157,17194137,6084652,1173148,50194712,6110885,50075600,50289740,2065816,1999578,50628933,17097907,17038330,1060073,6117976,1090840,1189623,4019223,1020857,10004360,2062076,17253913,17031605,4056208,1148722,1124825,50090188,17179579,17014847,1122394,50549337,1163409,1999624,50458485,50086121,50786427,5059648,17130532,17030270,2059826,17028386,1059015,50194716,2010082,17101110,4066369,8094597,1096240,50088455,6121116,1103000,50094764,50316114,6136337,50094763,6548479,2009004,17011939,8091321,50004080,1060679,6110701,4066441,17222635,50031274,50069545,1107133,50106327,17075604,17025227,6121517,6118944,50065693,17042360,2065471,4065137)



-----
WITH BASE AS (
select R.*,  A.PRODUCT_ID
from open.LDC_LOGERRLEORRESU r, open.or_order_Activity a
where (proceso like '%PRJOBRECOYSUSPRP%' or proceso like '%PRGENRECORP%')
And   fechgene >= '21/05/2020'
and r.order_id=a.order_id
AND R.ORDER_ID=(SELECT MAX(R3.ORDER_ID) FROM open.LDC_LOGERRLEORRESU r3, OPEN.OR_ORDER_aCTIVITY A3 WHERE R3.ORDER_ID=A3.ORDER_ID AND A3.PRODUCT_ID=A.PRODUCT_ID))
SELECT *
FROM BASE 
WHERE product_id in (5058205,17134226,17037505,2022115,17022929,4067856,2033653,10002960,2067592,50603720,17098058,2089152,2035882,5060561,17027441,2040279,4036072,17002244,1191394,50345232,2079446,4069077,5060878,17097849,4056263,2074261,17026183,17043715,4051177,6114345,2077328,17124369,17123337,17023339,17130570,17046269,17014401,2061138,2018903,2069325,2090457,17003779,2069547,17037850,17098069,2024589,17033518,1141400,14513682,8088887,17001084,50286199,4064994,17038806,2039269,17099865,50347873,17092818,17114510,17103114,4068092,2061331,2068644,2085005,2049953,50346990);
-----
with base as(
select distinct r.prcanuse, r.prcaobse, r.prcafeva
from open.LDC_PRVACASU r
where r.prcafeva=(select max(r3.prcafeva) from open.LDC_PRVACASU r3 where r3.prcanuse=r.prcanuse)
)
select *
from base r
where r.prcanuse in (17100054,6119157,50287557,1176462,50060183,2069187,50003526,17091989,17033286,6104792,2069957,2084416,2071399,6624474,6131865,50021689,17152861,17022044,17173170,2087094,14522738,50126616,1061335,2070145,50052877,50308031,6123366,1190845,17200527,5061489,50035574,50322436,50336272,2082924,6122858,1138522,50188096,17107259,4068049,4068141,17099554,17109522,17232090,17021382,50075594,1099258,2072502,1127785,50085180,6111839,50782310,1063302,50082811,2087975,2040151,1063749,2067545,6524123,50039160,6636592,5058810,4060094,2067909,1188943,50317967,50763833,17034841,17162688,17108668,17023524,4068042,50327179,50020936,6098918,17137188,50057134,4068789,5059464,2069803,50117750,50540682,1138791,2084603,50104105,17025181,14502068,17218585,17010313,50095004,1999582,36000089,50787736,1130415,4064290,17028081,50024156,50040744,17181852,17099446,50277873,1096362,17151774,1058446,17189239,6536603,17215182,4056010,50035849,1999577,17042930,17031546,17037709,2086667,1052098,2080046,6515138,6534102,8090949,8090090,50018664,1069248,50075483,50745271,2059851,2090622,1171669,17189229,2072889,50057865,2066863,50514106,6567106,50002109,17044485,2060681,50500685,17018623,50329894,50311290,17013802,1000530,1098180,50682202,6523090,6122277,50076988,2076096,50085367,2085815,50074642,5061569,6106322,50325532,1146287,2072933,1999595,1180565,8091560,50203764,17192988,17043223,2086870,2068497,50024155,50075252,2058317,17012745,17182952,2091941,2017955,50014310,1152549,5056288,2074613,50024157,17194137,6084652,1173148,50194712,6110885,50075600,50289740,2065816,1999578,50628933,17097907,17038330,1060073,6117976,1090840,1189623,4019223,1020857,10004360,2062076,17253913,17031605,4056208,1148722,1124825,50090188,17179579,17014847,1122394,50549337,1163409,1999624,50458485,50086121,50786427,5059648,17130532,17030270,2059826,17028386,1059015,50194716,2010082,17101110,4066369,8094597,1096240,50088455,6121116,1103000,50094764,50316114,6136337,50094763,6548479,2009004,17011939,8091321,50004080,1060679,6110701,4066441,17222635,50031274,50069545,1107133,50106327,17075604,17025227,6121517,6118944,50065693,17042360,2065471,4065137)

-------
with base as(
select distinct r.prreprod, r.prreobse, r.prrefepr
from open.LDC_PRODRERP r
where r.prrefepr=(select max(r3.prrefepr) from open.LDC_PRODRERP r3 where r3.prreprod=r.prreprod)
)

select distinct  base.*
from  base



select *
from open.LDC_LOGERRLEORRESU r, open.or_order_Activity a
where (proceso like '%PRJOBRECOYSUSPRP%' or proceso like '%PRGENRECORP%')
And   fechgene >= '20/04/2020'
and r.order_id=a.order_id
and r.order_id=228559430
group by a.product_id
and upper(menserror) like '%NULL%'

select *
from LDC_LOGERRLEORRESU
where order_id=142301656
;
select *
from open.LOG_ERRORES_CAMBIO_TISU r, open.or_order o
where r.fechgene>='18/11/2021'
  and r.order_id=o.order_id
  and o.task_type_id=10450

select *
from LDC_PRVACASU cc
where prcafeva>='23/04/2020' 
and cc.prcanuse=3020047
for update



select *
from ldc_defcri_noreparable
where id_producto=3020047;



SELECT *
FROM open.LDC_PRODRERP f
WHERE F.PRREPROC='S'
and f.prrefepr>='18/06/2020'
UNION
SELECT *
FROM open.LDC_PRODRERP f
WHERE F.PRREOBSE='X'
;


select count(distinct reinval1)
from open.reportes r, open.repoinco ri
where r.reponume=ri.reinrepo
  and r.repoapli='SUS_NOT_RP'
  and repofech>='21/04/2020 18:00:00'
  and reindes1='S';
  
  SELECT COUNT(1)
FROM OPEN.MO_PACKAGES
WHERE PACKAGE_TYPE_ID=100156
 AND MOTIVE_sTATUS_ID=13
 AND COMMENT_ LIKE '%JOB%'
 AND REQUEST_dATE>='21/04/2020';
 
 SELECT COUNT(1)
FROM LDC_PRODRERP;


select *
from open.ldc_osf_estaproc
where proceso = 'PRJOBRECOYSUSPRP' and FECHA_INICIAL_EJEC > sysdate - 1;
