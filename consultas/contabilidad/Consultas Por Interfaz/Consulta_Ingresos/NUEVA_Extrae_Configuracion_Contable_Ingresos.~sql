  SELECT
  A.COCOCODI COD_COMPROBANTE,
         A.COCODESC DES_COMPROBANTE,
         B.TCCOCODI COD_TIPCOMPROBANTE,
         B.TCCODESC DESC_TIPCOMPROBANTE,
         D.TIDCDESC DESC_TIPODOCUMENTO,
         E.TIMOCODI COD_TIPOMOVIMIENTO,
         E.TIMODESC DESC_TIPOMOVIMIENTO,
         F.CLCRCONS,
         G.CLCOCODI COD_CLASCONT,
         G.CLCODESC DESC_CLASCONT,
         c.corccrit Criterio_Compro,
         DECODE(G.CLCODOMI,'C','Concepto','B','Banco','T''Tipo Trabajo') DOMINIO,
         DECODE(I.RCCCVALO,'V','Valor Total',I.RCCCVALO) VALOR_REPORTAR,
         decode (I.RCCCNATU,'D',I.RCCCCUCO) CTA_CONTABLE_DB,
         decode (I.RCCCNATU,'C',I.RCCCCUCO) CTA_CONTABLE_CR,
         I.RCCCPOPA porcentaje,
         --J.CCRCCAMP||' '||J.CCRCOPER||' '||J.CCRCVALO CRITERIO
         (select listagg(J.CCRCCAMP||' '||J.CCRCOPER||' '||J.CCRCVALO||' ') within group(order by J.CCRCCAMP) as CAMPO
            from OPEN.IC_CRCORECO J
           WHERE J.CCRCCLCR(+)=F.CLCRCONS) Criterio
  FROM  OPEN.IC_COMPCONT A, OPEN.IC_TICOCONT B, OPEN.IC_CONFRECO C , OPEN.IC_TIPODOCO D ,
        OPEN.IC_TIPOMOVI E ,OPEN.IC_CLASCORE F , OPEN.IC_CLASCONT G,OPEN.IC_RECOCLCO I --, OPEN.IC_CRCORECO J
  WHERE
        --J.CCRCCLCR(+)=F.CLCRCONS and
        A.COCOCODI=C.CORCCOCO(+) AND
        C.CORCTIDO=D.TIDCCODI(+) AND
        C.CORCTIMO=E.TIMOCODI(+) AND
        C.CORCCONS=F.CLCRCORC(+) AND
        F.CLCRCLCO=G.CLCOCODI(+) AND
        F.CLCRCONS=I.RCCCCLCR(+) AND
        A.COCOTCCO=B.TCCOCODI(+)
        AND G.CLCODOMI = 'C'
        and B.TCCOCODI = 1
