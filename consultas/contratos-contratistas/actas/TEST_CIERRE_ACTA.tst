PL/SQL Developer Test script 3.0
44
-- Created on 12/04/2019 by DIASAL 
declare 
   DTFECHAFINAL              DATE;
   SBFECHA_FINAL             GE_BOINSTANCECONTROL.STYSBVALUE;
   NUACTA                    GE_ACTA.ID_ACTA%TYPE;
   SBFLAG                    GE_BOINSTANCECONTROL.STYSBVALUE;
   CNUERROR_NO_DETAILS       GE_MESSAGE.MESSAGE_ID%TYPE := 6762;
begin

        NUACTA :=75012;
        SBFLAG          := OR_BOCONSTANTS.CSBSI;
        DTFECHAFINAL    := TO_DATE(DAGE_ACTA.FDTGETFECHA_FIN(NUACTA), UT_DATE.FSBDATE_FORMAT);
        
        GE_BOCERTIFICATE.LOCKCERTIFICATEBYPK(NUACTA);
        
        IF NOT CT_BCCERTIFICATE.FBLHASDETAILS(NUACTA) THEN
            
            ERRORS.SETERROR(CNUERROR_NO_DETAILS);
            RAISE EX.CONTROLLED_ERROR;
        END IF;


        GE_BOCERTIFCONTRATISTA.CERRARACTA
        (
            NUACTA,
            DTFECHAFINAL,
            SBFLAG
        );
        COMMIT;
        
        UT_TRACE.TRACE('FIN EjecutarCierreActa',12);


        --GE_BOIOPENEXECUTABLE.SETONEVENT(CNUEXECUTABLE_REP, 'POST_REGISTER' );
        PROCESOPOSTCERRARACTA(NUACTA);
EXCEPTION
        WHEN EX.CONTROLLED_ERROR THEN
            ROLLBACK;
            RAISE EX.CONTROLLED_ERROR;
        WHEN OTHERS THEN
            ERRORS.SETERROR;
            ROLLBACK;
            RAISE EX.CONTROLLED_ERROR;        
end;
0
0
