with base as( 
 select d.object_name
 from dba_objects d
 where d.OWNER='OPEN'
   and d.OBJECT_TYPE in ('PROCEDURE','FUNCTION','PACKAGE','PACKAGE_BODY')
   and not exists(select null from dba_source s where s.owner=d.owner and s.name=object_name and upper(s.TEXT) like '%WRAPPED%')
 ),
 pb as(
 select object_name
 from dba_objects
 where object_name in ('TT_BOFWDAMAGEATTEND','PKIC_UICHANGESTATENEWS','PKBCNR_NEGOCIAC','FRCGETUNIDOPERTECCERT','LD_BOLEGALIZESALE','TT_BOFWDAMAGEELEMENT','LDC_BCLEGALORDENVENTAS','LDC_ASIGDIRCONTRUCTORAS','LDC_SCORUTIL','LDCI_PKBSSPORTALWEB','LDC_PKPBGOC','AB_BOFWADDRESSCHANGE','GE_BOFWOPEUNIITEMBALA','CC_UIOSSANSWER','GE_BOFWAIUPROCESS','IF_BOFWELEMENTOUTAGE','OR_BOFW_UPDLEGALIZEPASSWORD','OR_BOFW_ADDCOMENTTOORDER','IC_UIDETAILEDSUSCRIPTION','RC_UIRETURNEDDOCUMENTS','RC_BOINFENTIDADESRECAUDO','CA_UIPROCESOSCAJA','CM_BOFWCHANGEMETER','CM_BOCORRECTFACTORSVARS','CM_UIASOCMEDIAREACOMUN','CM_UIACTMETODOANALISIS','FA_UIGENARCHSOLICCAE','FA_UIRECEPARCHCAE','LDC_REGISTERNTL','DL_UIREVERREPROCDATCARG','LE_BOCARGARTARIFASARCHIVO','LE_BORATINGEVENTPROCESS','LE_BORECEPCIONARCHIVOCIBER','LE_BOMANAGERDETAILROAMING','OR_BOFW_LEGALIZEPASSWORD','LDC_BCCHANGEQUOTAVALUE','LDC_BCRETROACTIVOS','GDO_REPORTESFACTURACION','LDC_USUARIOSEXENTOS','CM_BOGENPRODCONSVAR','LDC_BOPROCESSLDCLT','LDCI_GENERAREPORTEBRILLA','LDC_CCMPV','LDC_UILDCIDO','PROGUARDAASIGOTTECRE','LDC_PKTRASFNB','LDC_BCSALESCOMMISSION_NEL','LDC_PRLIQUIDACONTRA','PROCESSVARACTANOVE','LDC_PKGENAJUSMASI','LDC_PKOSSSUPENCMXVALVULA','LDC_VALDATOSLDCRVPCON','LDC_PRVALDATCAMBCLIENT','PKLDCPS','GE_BOFWTECHNICALSERVICE','IF_BOFWMAINTENANCEPROC','PKFB_UIDEFTOCURRPRODTRANSFER','FA_UIRECAUTOFGRA','LDC_BCORDENCONCILACION','LE_BOCALENDARIOLIQ','FA_UIRECFCFC','FA_UIMICROFILMDOCDEVFMDD','RC_BOPAYMENTPOINT','PKBCCONSUMPTIONVARANA','GC_UICANCELINCLUSION','BI_UIPROCESOSFACTURACION','CA_UIANULARDOCUMENTO','LDC_FNCONSULTAIPLI','LDCI_PKMOVIMATERIAL','LDC_CONSULTAVALDESMONTE','LDC_PKLDCCO','PKLD_CREDIT_BUREAU_QUERY','LDC_PKGACTUALIZALISCOST','OR_BOFWASSIGNORDER','LDC_PKG_CAMFEC','AB_BOADDRESSPROCESSBYFILE','CT_BOFWNOVELTY','CC_BOQUOTATIONPRINTING','FM_BOREQUEST','GE_BOVARTEMPLATES','GE_BOFWLISTUNITARYCOST','IM_BOXMLINFLUENCE','SA_BOFWUSERS','OR_BOFWROUTEITINERA','OR_BOFWAUTOASSIGNREPROGORDER','OR_BOFW_PROCESS','IC_UIREPCARTPORCONC','LD_BOSUBSIDY','LE_BOPROCMOVTERCEROPORFECHAS','IR_UIPROCRECFCTB','FA_UIPROCRECFESF','FA_UIPROCRECFRIA','GB_UIREPINCONSITENCIAS','NR_UIUPDBORDERCONSUM','GC_UIGENNOTENTICALIF','BI_BOFWREPFACTURACION','LE_BOGENERACIONARCHIVOCIBER','LE_UILIMITECREDITO','LDC_SEGURIDADES','TT_BOFW_PROCESS','CA_UICUADREINDIVIDCAJA','OR_BOFW_CREATEORDER','MO_BSEXECUTOR_LOG_MOT','GC_UICAMESTACTGESTCOBR','GC_UIASIGENTICOBRSUSC','LDC_BOREPORTECARTBRILLA','LDC_PKGESTLIQPNO','LD_BOPACKAGEFNB','LDC_OSSCONFCONTRACTFIBCS','LDC_PROELIMINAEQUIPAMENTO','LD_BCGENERATIONRANDOMSAMPLE','OR_BORETURNORDERS','GDO_REPORCOMPVINCULACION','LDC_REPLEYSEGAUD','LDC_PRANULACONSECUTIVO','LDC_BORECAUDOS','LDC_PROCVALDESMONTE','PRVALLDCREASCO','LDC_PKGENLECTESP','LD_REPORT_GENERATION','LDC_PKGENERAESTRPB','LD_BOFILEBLOCKED','LD_BCUPLOADFILEINCONSISTENCY','PROCESSVALIDAORDENTRAB','LDC_REPORTESPROCESO','LDC_PKTARICONSFACT','GE_BOFWCONTRATISTAS','LDC_GENERAVTINGVIS','LDC_PKINFOAUDITORIA','LDC_PKMODICONT','PKACUCARTOT','LDCCAMBSEIT','LDC_PKGESTIONTATTPR','LDCI_PKREVISIONPERIODICAWEB','LDC_PKAJUSTASUSPCONE','PKGENIMPRCONTRASERV','LDC_PRVALPORDVENT','CT_BOFWCERTIFICATE','CC_BCLOADSCORPROCESSES','OR_BOFW_ANNULORDER','GC_UICANCELPLAZOCORTE','CM_BOFWRUBBISHROUTE','TT_BCDAMAGEPRODUCT','PKFB_UITRANSFERDEFERRED','LE_BORECHARGESERVICES','LE_BCRECHARGESERVICES','LDC_BOCERRARACTANEGATIVA','LDC_BOVENTACONSTRUCTORA','FM_BO_NTL_PROCESS','GE_BOFWGEOLOCATION','IF_BOFWMETERREGISTER','OR_BOFWCONFIRMARCITA','OR_BOFW_ASSIGNORDER','GE_BOFWITEMSTRASLADO','IC_UIPROGGENERATEPROV','IC_UIVERIFIACCOUNRECORDS','RC_UIPROCRECFIIR','RC_UIPROCRECFRRS','RC_BOUNINOVFILAUTODEB','NR_UILOADFILEPRICE','CM_UIREPORTECONSUMOS','LE_BOTAPNOTIFICATIONS','GC_UIPLAZOSSUSPPERM','CM_UIACTELEMMEDI','CC_BOUIAPPROVEPRODDMG','LDC_REPORTE_LEY','PKLD_FA_BSDISCOUNTAPPL','IC_UIICBGRC','GDO_REPORTECONSUMOS','LDC_REPORTE_SUI','LDC_REPLEYVENTAATECLIE','LDCI_PROCESOSINTERFAZSAP','LDC_DISTSALDFAVOCLIECAST','LDC_PKGESTIONACARTASREDES','LDC_PKVENTAGAS','LDC_BOCOTIZACIONCONSTRUCTORA','LDCPROCESCAMBIOFELEOT','PR_UPDATE_DATA_INSURED','LD_BOPRINTPAGARE','LDC_BSGESTIONREEXO','LDC_PRITEM_TASKTYPE_FILE','LDC_PKTRDIFSUBACTE','LDCPRRECAFEC','LDC_PRVALDATCARGCONTRATO','LDC_PR_CANTLEGAITEMS','LDC_PKGRUTCONTCAM','GENIFRS_DUMMY','LDC_PKGESTIONANULAVENTA','LDCI_TEMPPKGESTLEGAORDEN','LDC_CAMBIOESTDLICE','CT_BOORDERREVOKE','IF_BOCAPACITY','OR_BOFWROUTEZONE','CA_UIPACKAGESSEARCH','NR_UITELECNSMPUPDBYRAN','PKBCREPORTES','GC_UICANCELEXCLUSION','GC_UIREGISTROEXCLUSIONES','GC_UIREGISTROINCLUSIONES','LD_BCSUBSIDY','AB_BOFWADDRESS','LDC_FNCONSULTAORDENES','RC_BOCOLLECTFILERECPROC','LDC_ELIMINAREXCLUSION','LDC_RUTEROSCRM','LDC_PKORDENES','LDC_BOIMPFACTURACONSTRUCTORA','LDC_PKREGMASREVPERI','PK_PRODUCT_COMERCIAL_SECTOR','LD_BCFACTURACION','LDC_UIAPPROVEDREQUESTS','LDC_PKGENECUPOTOTVENCO','LDC_ACTUAPERICOSE','AB_BOFWSEGMENTS','AB_BOFWWAY_SYNONYM','GE_BOFWCERTIFCONTRATISTA','GE_BOFWGENERALCONFIGURATOR','GE_BOTECHNICALSERVICE','MO_BSATTENDACTIVITIES','IC_UIGENERAARCHTIPOMOVI','TT_BOFWOUTAGE','OR_BOPROGRAMING','OR_BOFWEJECUTARORDEN','OR_BOFW_ACTIVRETIRGROUP','RC_UICONTRACTRETURNDOC','PKBSPAYMENTREPORT','CM_BOREGLECT','GC_UIGENACCINFWRITEOFF','LC_BCSERVICIOSCOMPENSACION','LE_BOREVERTFILE','LDCI_PKINTERFAZACTAS','CC_BOCHANGEINTERACTION','LDCI_PKREASIGNAORDEN','PKLD_REPORTREFE','FA_BOJOINTBILLINGFILES','FA_BOCHARGEFILEGENERATION','PROCESSLIQCONTRADMIN','PROCESSESOLICITUD','IC_UIICBGHE','LDC_BCREVOKEOTS','LDC_BOASIGAUTO','PROGUARDADESASIGOTTEC','LDC_PROCCOSTINGR','LDC_PKDIRECO','LDCFTABLE_PROCESAR','LDC_PROCREPBR','LDC_ARCHTIPO_LISTA','LDC_PKRECNOSIN','LDCI_PKOSSVENTMOVILGESMANU','LDC_PRAJUSORDESINACTA','LDC_PRVALDATCAMBORDER','LDC_PKCONTRATO','LDC_PRACTUALIZAOTESDOC','LDCIGINTRO_DIA','OR_BOFWOPERATING_ZONE','LD_BOPORTAFOLIO','TT_BOFWFORWARDPROC','CM_BCELEMENTOSMEDICION','GC_UICANCELCONFCORTE','TA_BOUILIQTARIFFVALID','LDC_BOPROCESRUTEROS','OR_BOFW_ORDERSCONFIGURATOR','FA_BCJOINTBILLINGFILES','OR_BOFWASSIGNMASSIVORDER','LE_BOLIQPROPIAS','LDC_MASSIVEBRLEGALIZA','LDC_BOTRABAJOADICIONAL',' LDC_PKGENLECTESP','LDC_PKCRMFINANCIACION','OR_BOSERVICES','PKLD_BLOCKED_QUERY','LDCI_PKMOVIVENTMATE','LDC_UIFMAREG','LDC_PKGOTSSINCOBSINGAR','LDC_PKGGCMA','LDC_FNCONSULTAOTESDOC','CP_BOUICAMPAIGN','CC_BOPROREPOQUEJYRECL','CC_BOPROCARGAIMPEDIM','LE_BOREPORTESLIQT','RC_UIPROCRECFGRC','RC_BOVALIDATEFILELOAD','CA_UIINFOADICFORMPAGO','GB_UIDATOSSISTEMA','FA_UIENVIOFACTURAS','GC_UIPROGRAMACIONCORTE','LE_BOCOMPANYDATA','BI_UIREPORFACTURACONCEPTO','LE_BOFRAUDE','OR_BOFWCREATEORDERBYFILE','RC_UIASIGDEVSALDOFAVOR','LDC_PROREGISTRAPAGOACTA','IC_UICOMPLETSERVICEINT','OR_BOFW_LEGALIZEORDERBYFILE','OR_BOFW_ORDERADDITIONALDATA','RC_UIAUTMONTODEVSALDOFAVOR','LD_BOSECUREMANAGEMENT','GC_UICALIFCARTERASUSC','LDC_BCDELETECHARGES','LDC_PRGENERATEPORCPROVISION','MO_BOPROCESSMEDIATIONDATE','LCD_GENERABONIFICACION','LDC_PROCSERVPENDTE','LD_FA_REPORTGRAFICCR','LD_BOCOUPONPRINTING','LDC_BOVENTASFNB','LDC_REPPLANOATECLIE','LDC_INSACTCALLCENTER','LDC_PKGOSFFACTURE','LDC_UIFCDCRG','LDC_PKDLRCLPB','LDC_BCDELETECHARGEDUPL','LDCGENCOMASE_PROCESAR','LDC_PKLDCRPACERP','LDC_PKCARGALDRVOLU','LDC_PROCINFOESTABBYFILE','LDC_UIFGRCG','REVERSEEXECUTEORDER','LDC_BCCREG_BVENTA','LDC_PKUICARGAPERIODOS','GE_BOFWEMPAQUETAEQUIPOS','GE_BOBAJAEQUIPOS','IM_BOFWADDRINFLUENCE','PM_BOFWMASSIVEORDERS','OR_BOFWTRASLATACTIVITIES','RC_BOCOLLECTARRAGEMENT','LC_UICOMPENSATION','RC_UIINFPROCCARGNOVEDA','FA_UISEGUIMIENTOSUSCRIPC','LE_BOSERVICIOSFRAUDES','LE_BOLIQTERCEROS','OR_BOFWLOCKORDER','LD_BOLIQUIDATION','OR_BOFW_ORDERREVOKE','LDC_PKCRMTRAMISEGBRI','LDC_PKLDCCAIPA','FNUGETORDERFINISHED','LDC_PROCCONSULTAACTASABIERTAS','LDC_BO_GESTUNITPER','LDC_PKGENSOLAN','LDC_PKGRENORMOV','CC_BOUIPACKDATEREGISTER','RC_UIANULDEVSALDOFAVOR','CT_BOCONTRACT','CC_BOPROCESSADMACTJOB','IF_UIRESERVANUMERO','LE_BOCALPEGGEDEXCHANGERATE','LE_BORESUMENTRAFICODESTINO','LE_BOREPDESVIOCONSUMOS','GC_UICALIFICARENTICOBR','FA_UIPROCRECFRRO','RC_BSBANKTRANSACTIONS','CA_UICHANGECOLLECTBOXSTATUS','CA_UIREPORTECIERRESUCURSAL','NR_UIPRECIOBOLSADIARIO','PKBI_UIRECLAMO','GC_UISOLICITARPLAZOS','LE_BOEVENTINTERFACE','LE_BOTARIFFINDEXING','RC_UICAMBIARCONCILIAFCDC','PROGUARDAASIGOTTEC','GC_UIIMPRESIONCARTAS','CC_BOSALESCHANNEL','TT_BOFWADDCOMMENT','PKLD_FA_BCREGISTERMATRICULA','PR_BODATAUTILITIES','LDC_PROCESSLDRPLAM','GDO_REPORTEOYM','LDC_PROPERSECUSION_AOPCA','LDC_BCSALESCOMMISSION','LDC_BOASOBANCARIA2001','LDC_PKGENVENFORMASI','LDC_PKCARTARISEGU','LDC_BOGENORAPOADIC','  PKORDENESSINACTA','LDC_UISOLXML','LDC_PKCALIDADCARTERA','PROCESSLDGAVBR','PROGRAMA_LDC_LDRREPDIRCOBRO','LDC_UIEJECUTARORDEN','LDC_VALIDA_ORASAR','LDC_PROCESA_ITERACION','LDC_UIATENDEVSALDOFAVOR_PROC','LDC_RENEWPOLICIESBYCOLLECTIVE','FIACC_VALIDA','LDC_PKPROCESAOTINTERV','LDC_BOLDGIC','LDC_PROPERSECUSION','LDCLOCATEMP','LDC_PROCEXOGENA','OR_BOFWITEMSSERIADOS','GE_BOFWBUSQPERSONAS','SM_BOFWORDERMEDIATOR','PM_BOFWPROJECTUNITS','SA_BOFWUSERREGEN','OR_BOFWSECTOROPERATIVO','PKIC_UIPROGAUTOMATICEVENT','LDC_BOMETROLOGIA','LDC_MUES_ALEATORIA','PKTMPFILELISTMGR','FA_UIPROCESOSFACT','RC_UIANULARPAGO','FRFGETMONEYVALUE','RC_UITRASLADARPAGO','LE_BOLIMITEDECREDITO','IN_BOFW_INRMO_PB','LD_UICANCELLATIONS','FRCGETTECUNIDOPERTECCERT','LDC_BOOTBYQUOTATION','LDCI_RESETINTMENSCAJAGRIS','LDC_PKGPROCMUCTT','LDC_PKGESTPREXCLURP','LDC_PKFAAC','LDC_PKGINFOGESMOV','LDC_PKGCAMVAC','OR_BOFWBASEADMINISTRATIVA','IM_BOADDRINFLUENCE','OR_BOFWPROCESSORDER','OR_BOFWREASITINERARY','LDC_BOORDENCONCILACION','OR_BOGENORDINSPECC','OR_BOFWORDENESINSPECCION','IC_UIGENCARTCOMPCONC','LDC_BCPRELIQUIDACIONGC','RC_UIRELDOCUMENTCHANGE','GC_UICAMBPROGCARTSUSC','GC_UIENVPAGAJUENTICOBR','RC_UINOTEDBREACCONCEPT','CM_UIINFORMESCRITICA','NR_UIANADIAVARCONS','GC_UIPROGACTIVIDADES','NR_UICOMPCONSTELE','DL_UICARGADATOS','GC_UIGENREPSUSCRIPCIONSUSP','BI_UIREPORTESFACTURACION','FA_UIREPORTESDIFERIDOS','CA_UIREPTPROCESOARCHIVOSDA','ID_BOSUSCPORMENSAJESFACT','LE_BOCIERRETABLAS','TT_BOFWFAULT','FA_BOPAYMENTSFILES','RC_BSLEGPAYDOCRETURNED','IC_UIPORTFOLIOPROV','IC_UICERTIFICATESPROV','MO_BOPROCESSAPARTMENT','FABO_IUVISTAPREVIA','LDC_BOLEGALORDENVENTAS','RC_UIARCHIVOSRECAUDO','IC_UIICBPCC','LDCI_PKINTERFAZSAP','LDC_CHANG_CONTRACT_ORDER','LDC_REMARCAPRODUCTO','LD_BCPROCESS_BLOCKED','LDC_PRACTUALIZAORANPU','LDCTDC','LDC_PKBOCLOSE_CONTRACT','CT_UICTAMC','LDC_PROANULAREQUISICION','LDC_PKITEMSSERIADOS','LDC_PAQUETEANEXOA','LDC_UILDCPBLEORD','LDC_PKGESTIONLEGORDCRI','LDC_ACTFORMULARIO','LDC_PKVALIDASUSPCONE','LDC_PKGENEORADI','LDCDESENDNOTIFI','LDC_CREAR_ORDEN','LDC_BOLDCGCAUC','MO_BOFWSENTACTIVITIES','RC_BOGROUPPAYMENTS','PKBI_UINOTEPRINT','LE_BODISTRIBUCIONFRAUD','LE_BOINCONSISTENCYSERVICES','LDC_BCPERIODICREVIEW','LDC_LEG_IPLI_ASIG','LDC_BOVENTAEMPAQUETADA','LDC_BOITEMS_ESPECIALES','LDC_BOENCUESTA','LDC_FNCONSULTAORANPU','LDC_PKPAGOSCONSIG','LDC_PKGLIQUIDANOREGULADOS','LDC_IMPESTADOCUENTA','LDC_MATBLOQANILLO','LDC_PROCCONSULTAPRODOTSPNO','PKFB_UIDEFTOCURTRANSFER','LDC_PKGLDCGESTERRRP','LDC_APTEMPERATURAS','AB_BOFWWAY_BY_LOCATION','RC_UIPROCRECFPGA','CT_BOCERTIFICATE','CC_BOPETITIONMGR','PM_BOSERVICES','PKBI_UIDEFTOORDMASIVETRANS','LDC_BO_IMAGENCOLOMBIA','PKBI_UIDISTRIBUTECERTIFICATION','CA_UIINFOADICCHEQUE','CA_UIACTINFODOCUMCAJA','RC_BOCONSREGPAGOSCONTR','CM_UICARARCHINTERCOMER','GC_UICASTIGOCARTERAPR','FA_UIGENARCHRECLTERC','FABO_IUIMPRESIONPAGARE','LE_BOLOADCOMPTARIFFS','LE_BOTARIFFCOMPINDEXING','LE_BOLIQUIDADORROAMING','FA_UIAPROBPREFA','BI_UIREPAGRUPAPRODUCTOS','LE_BONOTIFICACIONLC','LE_BOCONTROLUMBRAL','LDC_REPINTECONTABLE','LDC_PKLDCCFA','LD_BOPRINTCOUPON','PROCESONOVALIDA','LDC_PRLEGALIZAOTFNB','LDC_BOSUSPENSIONS','PKLD_FA_BCAPLICATIONPPDM','GDO_MATRIZTRANSDETERIO','LDC_BOARCHIVO','LDC_PRORDENESIPLI','IC_UILISIMPROV','LDC_BOFACTURADEVENTA','LDC_BCPKASEM','LDC_LDRBTAF','LD_BCFILEGENERATION','OR_BOFW_CREATEORDERRELATED','PKORDENESSINACTA','LDCI_PKINTERFAZORDLEC','PR_UPDATE_VALUE_COTI','LD_BONONBANKFINANCING','LDC_PROACTUALIZATIPOMEDIDOR','LDC_PROLDEMAIL','LDC_PROGOAVC','LDC_BOCONCIL_USU_FACT','LDC_UILDC_FIFCAST','LDC_PROCERRARACTASABIERTAS','LD_BCNOTIFIMASCR','LD_BCAPROVE_RANDOM','LDC_VALIDCHECKITEMS','LDC_BOARCHIVOFTP','LDCPROINSPRODRED','LDC_PKREPORTEFIFAP','LDC_PROCCOSTOINGRE'))
 ,pi as(
 select upper(replace(REGEXP_SUBSTR(child_parent_service,'[^.]*.'),'.','') ) object_name
from open.GI_COMPOSITION_ADITI
where child_parent_service is not null
union
select upper(replace(REGEXP_SUBSTR(parent_child_service,'[^.]*.'),'.','') ) object_name
from open.GI_COMPOSITION_ADITI
where parent_child_service is not null)
 ,base2 as(
 select *
 from base
 where not exists(select null from dba_dependencies de where de.REFERENCED_NAME=base.object_name)
   and not exists(select null from open.gr_config_expression c where upper(c.object_name)=base.object_name)
   and not exists(select null from dba_triggers t where t.TRIGGER_NAME=base.object_name)
   and not exists(select null from open.sa_executable e where e.name=base.object_name))
,base3 as(select *
from base2
where not exists(select null from open.ge_object o where  upper(substr(o.name_,1, decode(instr(o.name_,'.'),0,length(o.name_), instr(o.name_,'.')-1))) =upper(base2.object_name))
 and not exists(select null from open.ldc_procedimiento_obj p where activo='S' and upper(procedimiento) not like '%PERSONALIZACIONES%' and replace(REGEXP_SUBSTR(procedimiento,'[^.]*.'),'.','')=base2.object_name)
 and not exists(select null from dba_jobs where upper(what) like '%'||base2.object_name||'%')
 and not exists(select null from dba_scheduler_jobs where upper(job_action) like '%'||base2.object_name||'%')
--  and 
)
select *
from base3
where not exists(select null from open.ge_statement where upper(statement) like '%'||base3.object_name||'%')
and not exists(select null from pb where pb.object_name=base3.object_name)
and not exists(select null from pi where pi.object_name=base3.object_name)
and not exists(select null from open.sa_tab where condition is not null and upper(condition)  like '%'||base3.object_name||'%')
--661
