 select  /*+ leading(or_uni_item_bala_mov)
           index(or_uni_item_bala_mov IDX_OR_UNI_ITEM_BALA_MOV01)
           index(ge_items_seriado PK_GE_ITEMS_SERIADO)
           index(ge_items PK_GE_ITEMS)
           index(ge_items_documento PK_GE_ITEMS_DOCUMENTO)*/
        OR_UNI_ITEM_BALA_MOV.ID_ITEMS_DOCUMENTO,
        MOVE_DATE MOVE_DATE,
        GE_ITEMS.ITEMS_ID||' - '||GE_ITEMS.DESCRIPTION DESCRIPTION,
        GE_ITEMS.CODE CODE,
        OR_UNI_ITEM_BALA_MOV.AMOUNT,
        OR_UNI_ITEM_BALA_MOV.TOTAL_VALUE,
        GE_ITEMS_SERIADO.SERIE,
        OR_UNI_ITEM_BALA_MOV.TARGET_OPER_UNIT_ID OPERATING_UNIT_ID,
        OR_UNI_ITEM_BALA_MOV.USER_ID,
        OR_UNI_ITEM_BALA_MOV.OPERATING_UNIT_ID TARGET_OPER_UNIT_ID,
        ge_items.item_classif_id
  from  OPEN.OR_UNI_ITEM_BALA_MOV,
        OPEN.OR_OPE_UNI_ITEM_BALA,
        OPEN.GE_ITEMS_SERIADO,
        OPEN.GE_ITEMS,
        OPEN.GE_ITEMS_DOCUMENTO
 where  OR_UNI_ITEM_BALA_MOV.ITEMS_ID = GE_ITEMS.ITEMS_ID
   and  OR_UNI_ITEM_BALA_MOV.ITEMS_ID = OR_OPE_UNI_ITEM_BALA.ITEMS_ID
   and  OR_UNI_ITEM_BALA_MOV.OPERATING_UNIT_ID = OR_OPE_UNI_ITEM_BALA.OPERATING_UNIT_ID
   and  OR_UNI_ITEM_BALA_MOV.MOVEMENT_TYPE = 'N' --or_boitemsmove.csbNeutralMoveType
   and  OR_UNI_ITEM_BALA_MOV.ID_ITEMS_DOCUMENTO = GE_ITEMS_DOCUMENTO.ID_ITEMS_DOCUMENTO
   and  OR_UNI_ITEM_BALA_MOV.SUPPORT_DOCUMENT = ' '
   and  OR_UNI_ITEM_BALA_MOV.ID_ITEMS_SERIADO = GE_ITEMS_SERIADO.ID_ITEMS_SERIADO (+)
   AND  or_uni_item_bala_mov.operating_unit_id  in (1774,1775,1933,1773,1931,1932)
   and ge_items_documento.id_items_documento=47545
   and not exists( select null
						 from open.LDCI_DOCUTRAN
						where DOTRDOCU = GE_ITEMS_DOCUMENTO.id_items_documento  )
   and ge_items_documento.id_items_documento not in (249871);
   
   
-- Reporte de items en transito
 select  /*+ leading(or_uni_item_bala_mov)
           index(or_uni_item_bala_mov IDX_OR_UNI_ITEM_BALA_MOV01)
           index(ge_items_seriado PK_GE_ITEMS_SERIADO)
           index(ge_items PK_GE_ITEMS)
           index(ge_items_documento PK_GE_ITEMS_DOCUMENTO)*/
        OR_UNI_ITEM_BALA_MOV.ID_ITEMS_DOCUMENTO,
        TRUNC(MOVE_DATE) MOVE_DATE,
        GE_ITEMS.ITEMS_ID||' - '||GE_ITEMS.DESCRIPTION DESCRIPTION,
        GE_ITEMS.CODE CODE,
        OR_UNI_ITEM_BALA_MOV.AMOUNT,
        OR_UNI_ITEM_BALA_MOV.TOTAL_VALUE,
        GE_ITEMS_SERIADO.SERIE,
        OR_UNI_ITEM_BALA_MOV.TARGET_OPER_UNIT_ID OPERATING_UNIT_ID,
        OR_UNI_ITEM_BALA_MOV.USER_ID,
        OR_UNI_ITEM_BALA_MOV.OPERATING_UNIT_ID TARGET_OPER_UNIT_ID
  from  OPEN.OR_UNI_ITEM_BALA_MOV,
        OPEN.OR_OPE_UNI_ITEM_BALA,
        OPEN.GE_ITEMS_SERIADO,
        OPEN.GE_ITEMS,
        OPEN.GE_ITEMS_DOCUMENTO
 where  OR_UNI_ITEM_BALA_MOV.ITEMS_ID = GE_ITEMS.ITEMS_ID
   and  OR_UNI_ITEM_BALA_MOV.ITEMS_ID = OR_OPE_UNI_ITEM_BALA.ITEMS_ID
   and  OR_UNI_ITEM_BALA_MOV.OPERATING_UNIT_ID = OR_OPE_UNI_ITEM_BALA.OPERATING_UNIT_ID
   and  OR_UNI_ITEM_BALA_MOV.MOVEMENT_TYPE = 'N' --or_boitemsmove.csbNeutralMoveType
   and  OR_UNI_ITEM_BALA_MOV.ID_ITEMS_DOCUMENTO = GE_ITEMS_DOCUMENTO.ID_ITEMS_DOCUMENTO
   and  OR_UNI_ITEM_BALA_MOV.SUPPORT_DOCUMENT = ' '
   and  OR_UNI_ITEM_BALA_MOV.ID_ITEMS_SERIADO = GE_ITEMS_SERIADO.ID_ITEMS_SERIADO (+)
   and  OR_UNI_ITEM_BALA_MOV.ID_ITEMS_DOCUMENTO = 33938;
 -- Reporte de items en transito
 select  /*+ leading(or_uni_item_bala_mov)
           index(or_uni_item_bala_mov IDX_OR_UNI_ITEM_BALA_MOV01)
           index(ge_items_seriado PK_GE_ITEMS_SERIADO)
           index(ge_items PK_GE_ITEMS)
           index(ge_items_documento PK_GE_ITEMS_DOCUMENTO)*/
        OR_UNI_ITEM_BALA_MOV.ID_ITEMS_DOCUMENTO,
        TRUNC(MOVE_DATE) MOVE_DATE,
        GE_ITEMS.ITEMS_ID||' - '||GE_ITEMS.DESCRIPTION DESCRIPTION,
        GE_ITEMS.CODE CODE,
        OR_UNI_ITEM_BALA_MOV.AMOUNT,
        OR_UNI_ITEM_BALA_MOV.TOTAL_VALUE,
        GE_ITEMS_SERIADO.SERIE,
        OR_UNI_ITEM_BALA_MOV.TARGET_OPER_UNIT_ID OPERATING_UNIT_ID,
        OR_UNI_ITEM_BALA_MOV.USER_ID,
        OR_UNI_ITEM_BALA_MOV.OPERATING_UNIT_ID TARGET_OPER_UNIT_ID
  from  OPEN.OR_UNI_ITEM_BALA_MOV,
        OPEN.OR_OPE_UNI_ITEM_BALA,
        OPEN.GE_ITEMS_SERIADO,
        OPEN.GE_ITEMS,
        OPEN.GE_ITEMS_DOCUMENTO
 where  OR_UNI_ITEM_BALA_MOV.ITEMS_ID = GE_ITEMS.ITEMS_ID
   and  OR_UNI_ITEM_BALA_MOV.ITEMS_ID = OR_OPE_UNI_ITEM_BALA.ITEMS_ID
   and  OR_UNI_ITEM_BALA_MOV.OPERATING_UNIT_ID = OR_OPE_UNI_ITEM_BALA.OPERATING_UNIT_ID
   and  OR_UNI_ITEM_BALA_MOV.MOVEMENT_TYPE = 'N' --or_boitemsmove.csbNeutralMoveType
   and  OR_UNI_ITEM_BALA_MOV.ID_ITEMS_DOCUMENTO = GE_ITEMS_DOCUMENTO.ID_ITEMS_DOCUMENTO
   and  OR_UNI_ITEM_BALA_MOV.SUPPORT_DOCUMENT = ' '
   and  OR_UNI_ITEM_BALA_MOV.ID_ITEMS_SERIADO = GE_ITEMS_SERIADO.ID_ITEMS_SERIADO (+)
   and  OR_UNI_ITEM_BALA_MOV.ID_ITEMS_DOCUMENTO = 33939;   
   
-- lista la informacion de los posiciones
select MMITCODI MOVI_ID, MMITDSAP DOC_SAP, MMITCLIE NIT, MMITESTA ESTADO, MMITINTE INTENTOS, DMITCOUN,
      /*MMITMENS MSG_ERR,*/ MMITFESA FECHA_SALIDA, DMITITEM COD_SAP, DMITCOIN COD_OSF, DMITCANT CANTIDAD, DMITCAPE, DMITMARC
  from OPEN.LDCI_INTEMMIT, OPEN.LDCI_DMITMMIT
 where MMITCODI = MMITCODI
   and MMITCODI = DMITMMIT
   and MMITCODI = 1599 /*Id de movimiento exitoso*/;   

-- lista la informacion de los posiciones
select MMITCODI MOVI_ID, MMITDSAP DOC_SAP, MMITCLIE NIT, MMITESTA ESTADO, MMITINTE INTENTOS, DMITCOUN, MMITFESA FECHA_SALIDA, DMITITEM COD_SAP, DMITCOIN COD_OSF, DMITCANT CANTIDAD, DMITCAPE, DMITMARC
  from OPEN.LDCI_INTEMMIT, OPEN.LDCI_DMITMMIT
 where MMITCODI = MMITCODI
   and MMITCODI = DMITMMIT
   and MMITCODI = 1600 /*Id de movimiento fallido*/;   
