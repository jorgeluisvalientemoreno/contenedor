SELECT *
FROM OPEN.GE_DOCUMENT_TYPE T
WHERE DOCUMENT_TYPE_ID NOT IN (118,101,102,103,104,105,115)
  AND DOCUMENT_TYPE_ID IN (SELECT DISTINCT D.DOCUMENT_TYPE_ID FROM OPEN.GE_ITEMS_DOCUMENTO D)
ORDER BY 1;

SELECT *
FROM OPEN.GE_ITEMS_DOCUMENTO D
WHERE FECHA>'01/01/2015'
  AND DOCUMENT_TYPE_ID = 118
  AND NOT EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE D.ID_ITEMS_DOCUMENTO=M.ID_ITEMS_DOCUMENTO);
   --PEDIDOS DE VENTA
   SELECT D.*--, (SELECT MMITNUPE FROM OPEN.LDCI_INTEMMIT WHERE MMITDSAP=DOCUMENTO_EXTERNO) PED
FROM OPEN.GE_ITEMS_DOCUMENTO D
WHERE FECHA>'01/01/2015'
  AND DOCUMENT_TYPE_ID=101
  AND NOT EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE D.ID_ITEMS_DOCUMENTO=M.ID_ITEMS_DOCUMENTO AND MOVEMENT_TYPE='I' )
  AND EXISTS (SELECT NULL FROM OPEN.LDCI_INTEMMIT WHERE MMITDSAP=DOCUMENTO_EXTERNO AND MMITNUPE IS NOT NULL) ;
  
  
  --NO PEDIDOS VENTA
  SELECT D.*, (SELECT MMITTIMO FROM OPEN.LDCI_INTEMMIT WHERE MMITDSAP=DOCUMENTO_EXTERNO) PED
  FROM OPEN.GE_ITEMS_DOCUMENTO D
  WHERE FECHA>'01/01/2015'
    AND DOCUMENT_TYPE_ID=101
  AND (SELECT SUM(AMOUNT) FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE D.ID_ITEMS_DOCUMENTO=M.ID_ITEMS_DOCUMENTO )!=
  (SELECT SUM( DMITCANT) FROM OPEN.LDCI_INTEMMIT, OPEN.LDCI_DMITMMIT WHERE MMITDSAP=DOCUMENTO_EXTERNO AND MMITCODI=DMITMMIT)
  AND NOT EXISTS (SELECT NULL FROM OPEN.LDCI_INTEMMIT WHERE MMITDSAP=DOCUMENTO_EXTERNO AND MMITNUPE IS NOT NULL) ;
  ;
  
    --NO PEDIDOS VENTA
  SELECT D.*, (SELECT MMITTIMO FROM OPEN.LDCI_INTEMMIT WHERE MMITDSAP=DOCUMENTO_EXTERNO) PED
  FROM OPEN.GE_ITEMS_DOCUMENTO D, OPEN.OR_OPERATING_UNIT U
  WHERE FECHA>'01/01/2015'
    AND DOCUMENT_TYPE_ID=103
    AND U.OPERATING_UNIT_ID=D.OPERATING_UNIT_ID
    AND U.OPER_UNIT_CLASSIF_ID!=11
    AND NOT EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE D.ID_ITEMS_DOCUMENTO=M.ID_ITEMS_DOCUMENTO )
    AND EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE TO_CHAR(D.ID_ITEMS_DOCUMENTO)=M.SUPPORT_DOCUMENT );
 
    SELECT D.*, (SELECT MMITTIMO FROM OPEN.LDCI_INTEMMIT WHERE MMITDSAP=DOCUMENTO_EXTERNO) PED
  FROM OPEN.GE_ITEMS_DOCUMENTO D, OPEN.OR_OPERATING_UNIT U
  WHERE FECHA>'01/01/2015'
    AND DOCUMENT_TYPE_ID=104
    AND U.OPERATING_UNIT_ID=D.OPERATING_UNIT_ID
    --AND U.OPER_UNIT_CLASSIF_ID!=11
    AND NOT EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE D.ID_ITEMS_DOCUMENTO=M.ID_ITEMS_DOCUMENTO );
 

  --traslados
      SELECT D.*
  FROM OPEN.GE_ITEMS_DOCUMENTO D
  WHERE FECHA>'01/01/2015'
    AND DOCUMENT_TYPE_ID=105
    AND NOT EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE D.ID_ITEMS_DOCUMENTO=M.ID_ITEMS_DOCUMENTO and movement_type='D')
    AND EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE D.ID_ITEMS_DOCUMENTO=M.ID_ITEMS_DOCUMENTO and movement_type='N');
  
  
  SELECT D.*
  FROM OPEN.GE_ITEMS_DOCUMENTO D
  WHERE FECHA>'01/01/2015'
    AND DOCUMENT_TYPE_ID=115
    AND NOT EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE D.ID_ITEMS_DOCUMENTO=M.ID_ITEMS_DOCUMENTO and movement_type='I')
    AND  EXISTS(SELECT NULL FROM OPEN.OR_UNI_ITEM_BALA_MOV M WHERE TO_CHAR(D.ID_ITEMS_DOCUMENTO)=M.SUPPORT_DOCUMENT )
    
     SELECT D.*
  FROM OPEN.GE_ITEMS_DOCUMENTO D
  WHERE FECHA>'01/01/2015'
    AND DOCUMENT_TYPE_ID IN (107,112,113,117);
select *
    from open.OR_UNI_ITEM_BALA_MOV
    where id_items_documento=418710
