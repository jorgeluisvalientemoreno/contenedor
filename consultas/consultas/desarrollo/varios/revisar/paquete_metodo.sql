DECLARE
  CURSOR CUDATOS IS
  WITH BASE AS(SELECT OBJECT_NAME, OBJECT_NAME||'.'||PROCEDURE_NAME PROCESO , ROWNUM FILA FROM dba_procedures where owner='OPEN' AND OBJECT_TYPE='PACKAGE'
  AND PROCEDURE_NAME NOT LIKE '%FSBVERSION%'
  AND OBJECT_NAME NOT LIKE 'LDC%'
  AND OBJECT_NAME NOT LIKE 'DALDC_%'
 
  ORDER BY OBJECT_NAME, PROCEDURE_NAME)
  SELECT *
  FROM BASE
  WHERE  FILA>20000
    AND FILA <=20100;
  
  CURSOR LINEAS(SBPROCESO VARCHAR2, PAQUETE VARCHAR2) IS
  SELECT  A.name, A.type, A.line, A.TEXT
  FROM ALL_SOURCE A
 where  UPPER(TEXT) LIKE UPPER('%'||SBPROCESO||'%%')
   AND  A.name !=PAQUETE
 ORDER  BY NAME, TYPE;
 
 SBDATOS VARCHAR2(4000);
BEGIN
    FOR REG IN CUDATOS LOOP
      BEGIN
      SBDATOS:=NULL;

      FOR REG2 IN LINEAS(REG.PROCESO, REG.OBJECT_NAME) LOOP
         IF SBDATOS IS NULL THEN
           SBDATOS:= REG.PROCESO;
           DBMS_OUTPUT.PUT_LINE(REG.PROCESO||'------------------------------------------------------------------------------');
          END IF;
         DBMS_OUTPUT.PUT_LINE(REG2.NAME||'-'||REG2.TYPE);
      END LOOP;
      
      EXCEPTION
        WHEN OTHERS THEN
          NULL;
      END;
    END LOOP;
END;
--12 MIN
