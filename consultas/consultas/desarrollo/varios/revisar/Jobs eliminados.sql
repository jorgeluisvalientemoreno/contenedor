SELECT E.NAME,
       S.LOG_USER,
       S.PROCESS_SCHEDULE_ID,
       S.PARAMETERS_,
       S.STATUS,
       S.FREQUENCY,
       O.*
FROM OPEN.GE_PROCESS_SCHEDULE S
INNER JOIN OPEN.SA_EXECUTABLE E ON E.EXECUTABLE_ID=S.EXECUTABLE_ID
 LEFT JOIN OPEN.GE_OBJECT O ON 'OBJECT_ID='||O.OBJECT_ID=S.PARAMETERS_
WHERE JOB!=-1
  AND NOT EXISTS(SELECT NULL FROM DBA_JOBS J WHERE J.JOB=S.JOB)
  AND  log_user NOT in ('ELEVAR','JULGON');
  
  
SELECT E.NAME FORMA,
       S.LOG_USER USUARIO,
       S.PROCESS_SCHEDULE_ID, 
       S.PARAMETERS_,
       S.STATUS,
       S.FREQUENCY,
       decode(S.FREQUENCY,'UV','UNA VEZ','DI','DIARIO','TM','MINUTOS','HR','HORAS','SE','SEMANAL') FRECUENCIA,
       S.START_DATE_ FECHA_INICIO,
       job,
       O.OBJECT_ID,
       O.DESCRIPTION,
       o.name_,
       sc.frequency_value,
       SD.Parameter
FROM OPEN.GE_PROCESS_SCHEDULE S
INNER JOIN OPEN.SA_EXECUTABLE E ON E.EXECUTABLE_ID=S.EXECUTABLE_ID
 LEFT JOIN OPEN.GE_OBJECT O ON 'OBJECT_ID='||O.OBJECT_ID=S.PARAMETERS_
 left join OPEN.GE_PROC_SCHE_COND sc on sc.process_scheduled_id=s.process_schedule_id
 LEFT JOIN OPEN.GE_PROC_SCHE_DETAIL SD ON SD.PROCESS_SCHEDULE_ID=S.PROCESS_SCHEDULE_ID
WHERE JOB!=-1
  AND  EXISTS(SELECT NULL FROM DBA_JOBS J WHERE J.JOB=S.JOB)
  AND E.NAME='GEMPS'
  and log_user in ('ELEVAR','JULGON')
union all  
SELECT E.NAME FORMA,
       S.LOG_USER USUARIO,
       S.PROCESS_SCHEDULE_ID, 
       S.PARAMETERS_,
       S.STATUS,
       S.FREQUENCY,
       decode(S.FREQUENCY,'UV','UNA VEZ','DI','DIARIO','TM','MINUTOS','HR','HORAS','SE','SEMANAL') FRECUENCIA,
       S.START_DATE_ FECHA_INICIO,
       job,
       O.OBJECT_ID,
       O.DESCRIPTION,
       o.name_,
       sc.frequency_value,
       SD.Parameter
FROM OPEN.GE_PROCESS_SCHEDULE S
INNER JOIN OPEN.SA_EXECUTABLE E ON E.EXECUTABLE_ID=S.EXECUTABLE_ID
 LEFT JOIN OPEN.GE_OBJECT O ON 'OBJECT_ID='||O.OBJECT_ID=S.PARAMETERS_
 left join OPEN.GE_PROC_SCHE_COND sc on sc.process_scheduled_id=s.process_schedule_id
 LEFT JOIN OPEN.GE_PROC_SCHE_DETAIL SD ON SD.PROCESS_SCHEDULE_ID=S.PROCESS_SCHEDULE_ID
WHERE JOB!=-1
  AND not EXISTS(SELECT NULL FROM DBA_JOBS J WHERE J.JOB=S.JOB)
  AND E.NAME='GEMPS'
  and log_user in ('ELEVAR','JULGON')  
;
  

  

