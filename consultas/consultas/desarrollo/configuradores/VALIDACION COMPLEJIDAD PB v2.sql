WITH formas_pb AS(
SELECT extractvalue(app_xml, 'PB/APPLICATION/ALLOW_SCHEDULE') es_programable ,distribution_file_id, extractvalue(app_xml, 'PB/APPLICATION/OBJECT_NAME') proceso
FROM OPEN.ge_distribution_file  , open.sa_executable e
where distribution_file_id=e.name
  and e.executable_type_id=8
  and e.name in ('P_BLOQUEO_DESBLOQUEO_DE_CUPO_100254','CNCRM','LEGO','P_LD_FA_SOLICITUD_100232','P_REGISTRO_PROTECCION_DATOS_PERSONALES_100265','P_SOLICITUD_DE_INFORMACION_GENERAL_100214','P_NOTIFICACION_POR_CORREO_ELECTRONICO_100378','LDSEMAIL','P_SOLICITUD_DE_GARANTIA_100257','LDCIF','LDCLNKFAC','FMIO','P_SOLICITUD_DE_GESTION_100313','P_SOLICITUD_CONTACTO_GESTION_DE_COBRO_100204','P_ACTUALIZAR_DATOS_DEL_PREDIO_100220','P_MODIFICACION_A_FECHA_DE_VENTA_DE_PREDIO_100224','P_LDC_SOLICITUD_VISITA_IDENTIFICACION_CERTIFICADO_100237','FDPCI','P_SAC_SERVICIOS_NUEVOS_100323','PCFO','P_SOLICITUD_DE_VENTAS_SAC_100304','LDCPIA','P_ACTUALIZACION_DE_CLIENTE_A_CONTRATO_100221','P_CAMBIO_DE_PLAN_COMERCIAL_GAS_100226','P_CAMBIO_DE_USO_DEL_SERVICIO_100225','P_SOLICITUD_SAC_GESTION_ADMINISTRATIVA_100360','P_ACTUALIZACION_DE_DATOS_DE_CLIENTE_100216','P_SOLICITUD_DE_VISITA_FNB_100251','P_SOLICITUD_SAC_FINANCIACION_NO_BANCARIA_100308','CERTRP','P_REPORTE_DE_INMUEBLE_DESOCUPADO_100303','LDCCGVF','LDPAR','P_REGISTRO_DE_PNO_100260','P_SOLICITUD_DE_FACTIBILIDAD_100341','P_LBC_VENTA_COTIZADA_100229','LDCCAP','PERSCA','PLUGIN','LDCGEVEINVIS','P_SOLICITUD_DE_RED_100207','LDCCOAGVSI','LDC_CTNLC','FAOXU','P_LDC_SOLICITUD_DE_RECONEXION_TRAMITES_INTERNOS_100333','UOBYSOL','P_LDC_SOLICITUD_DE_RECONEXION_100240','LDCALCI','LDCICONTANTIC','LDCIMINTCON','VACOIA','LDCAIOSA','LDCMIOSA','LDCGESTTA','LECTESPCRIT','LDCCONFTITRLEGA','LDCINIINTE','LDCFAAPR','LDROE','LDICU','LDCICTATICO','LDCICCGCLA','LDCGCAM','LDCLEGO','TIPOTRAB','LDCSOLXML','LDC_FCVC','LDCCUAI','LDCGENRVP','GEMMOM','LDCISOMA','ORCREST','FMTTPS','LDCGPAD','LDCTIPSOLPLANES','FGPC','LDCRECAFEC','LDCMDCAFEC','LDCCCAD','CIERRECARTERA','GCORECA','LDCFAAC','LDCFAPC','LDCCTI','LDCCOPYFACT','LDCACGEOL','LDCACCO','FDCP','FGDP','LDCFPAN','LDCARGPAG','LDCGCTGCA','LDCCPACO','LDCZOLOOFCA','LDCCOUNCOOF','ASEM','LDCITUNRA','LDCCOAPAHCA','LDCCA','LDC_CTSACC','LDCNR','LDCIMTPB','LDC_CCMPV','LDC_CCGEJE','LDCRPACER','LDCCAREXCLPR','LDC_MTITRACOP','LDCCOTTACCP','LDCTCSL','LDCCS','LDCCCANU','LDCGFV','LDEJO','LDC_CARGINFO','LDCSU','LDCACTFOR','LDCMBA','LDISP','LDCON','CTCVENEL','LDPUT','LDCEMC','LDCOTL','ASIMADI','CCALE','LDCPCF','LDCTEMPCAP','LDCVAFCLO','FDMPC','LDCMDOINT','LDCAPC','LDCLOCATEMP','LECTESP','MANOT','MPZNS','LDC_PROEVACAST','LDCDELEXCLPR','LDCNISP','LDCMETAMENSUAL','PBRCD','LDCUSUCUOININD','FICBS','LDAVACO','LDCRBAI_CIE','LDCDSCC','P_SOLICITUD_REPARACION_PRP_100294','LDCICLASIVA','LDCCCTSA','LDCTT','LDC_PROCSERVPENDTE','LDCIFOTOPROVCOST','LDCANC','GEMCSW','LDCASOCAMLTL','LDPBTIPORED','LDGCP','MDRESOGURE','LDCREGINTER','ORCUO','LDCLDQS','GESUNITPER','LDCIRAC','LDANS','LDFACTDUP','LDCES','P_SOLICITUD_SAC_REVISION_PERIODICA_100306','LDCCAS','LDCAU','P_LDC_SOLICITUD_ANULACION_RECLAMOS_100345','LDCLOCUNI','LDCORADI','LDCABRI','P_REGISTRO_DE_SINIESTROS_BRILLA_100299','ORMAP','LDCGESTERRRP','LDCUNITRP','FMPNO','P_CERTIFICACION_POR_SERVICIOS_NUEVOS_100314','PAMOT','LDCCFLOT','LDCAPANUL','LDCCOTANOPAGO','LDC_DIFEAPM','LODPD','ORASAR','P_SUSPENSION_VOLUNTARIA_100209','P_GENERACION_SOLICITUD_DE_CERTIFICACION_PRP_100295','LECTESPTC','LDCIPROCMONI','LDCINTACTASRO','LDCINITCOPR','LDCIACTLOCTRA','LDCIACTIVO','LDCITTINDIVA','LDCICCLOCT','LDCITIPORET','LDCIINDITEM','LDCIINDIRET','LDCINITCTACLAS','LDCICEBELO','LDTPDOCO','LDCITIPINTERF','LDCIPERIPROGINTE','LDCICLNITGEN','LDCICUENTA','LDCLVCON','LDCLCTOI','LDCCCBCT','LDCICONFCTACL','LDCISEGM','LECTESPC','PANOVA','LDCPBCAMFEC','LDCAPSOMA','GEMCUO','RCST','P_RECONEXION_VOLUNTARIA_100210','LDIPA','FMLE','P_TRAMITE_SALE_100231','CPTCB','LDCLT','LDCACD','LDCAPLAC','LDGPE','LDC_PRCOTSCOBSIGAR','LDCCLUO','CERTLAB','LDCIENVINT','LDCMOMAFELA','LDC_PROCCOSTOINGRE','LDCDEORREOF','P_LDC_DECLARATORIO_DEL_SILENCIO_ADMINISTRATIVO_POSITIVO_100202','FMACO','LDCPS','APRFMACO','P_SOLICITUD_EXCEPCION_COBROS_EN_LA_FACTURA_100267','APRFMLE','GOAVC','FIBLC','LDCPAVEN','P_LDC_RECURSOS_DE_APELACION_100213','IMFC','P_SOLICITUD_CARTAS_TIPO_100350','P_SOLICITUD_DE_RECONEXION_SIN_CERTIFICACION_100321','LDC_CTASCC','LDCPARP','LDCACTANUL','LDGRC','LDRPC','LDCATEMPVF','LDPSF','LDCIDEMA','P_TRASLADO_DE_PAGO_A_OTRO_CONTRATO_100227','FGCPC','LDCRIAICI','LDCFA','FDRCC','LDCMACOSIUS','LDCIGINTRO_DIA','LDCICETRLOCA','LDCIREPLICACECOTT','ORGINS','LDCCSPU','P_TRAMITE_DE_TERMINACION_DE_CONTRATO_100262','GEMMAR','GERMAR','LDCCIMAAC','LDCLIE','LDCFTPS','LDCACFILP','LDC_ITEM_TASKTYPE','LD_COPRAUAC','P_SOLICITUD_DE_DOCUMENTACION_SOPORTE_100211','P_SOLICITUD_DE_DUPLICADO_MESESE_ANTERIORES_100310','PBMAFA','LDGDB','P_ENTREGA_FISICA_DE_CHEQUE_DEVUELTO_100228','LDCIDETAINT','LDCTL','GENIFRS','LDCACTCERT','LDVDS','LDCDE','P_SOLICITUD_DE_REPORTE_DE_SINIESTRO_100263','LDC_PROCINCLUMAS','LDCDUPLIFACT','P_PAGO_POR_CONSIGNACION_100230','P_REGISTRO_DE_PLIEGO_DE_CARGOS_100203','GOPCVNEL','P_LDC_ACCION_POPULAR_100241','LDCCAMVAC','LDCAISPPRES','LDMENSPR','LDCREPANEXA','LECTESPGELE','LDCRGCOMA','LDCCONTTACOF','LDCREASCO','LDCCAPLOC','LDCDANE','LDCCPC','LDCCPF','LDCTDC','P_LDC_SUSPENSION_POR_SEGURIDAD_100283','LDCBSCIN','FRVAD','LDCCTCFLO','LDCFCIEAIP','P_SOLICITUD_ENTREGA_INFORMACION_ENTES_DE_CONTROL_100258','LDCAMOTA','P_SOLICITUD_DE_DONACION_100206','PAACT','ACOTESDO','PBACUCARTOT','LDCCONDET','LDCGENOGEPACOCAASI','FGRCP','LDCAISP','LDCIUPDFECO','LDCCO','LIQUIDACARTERA','LDCLOCRI','LDCIGINTMESRO','PBAREQ','P_SOLICITUD_DE_VISITA_CAPACITACION_A_COMUNIDADES_100250','LDCIPROVCOST','LDCCRELIPREC','LDCINTCONSUMORO','LDCPBLEORD','LDCCANUL','LDCHOIMIA','LDCMCCO','LDCGENSOLAN','LDC_DLRCLPBP','LDCUNOPFNB','MD_GARANTIAS','CCPU','FIACC','LDCCAMBSEIT','FIACR','LDCRMADCAR','LDCIGINTRO','LDCCOITCOBUSU','LDCTTTB','LDCRIAIC','LDCANDM','P_VENTA_A_CONSTRUCTORAS_323','LDPCF','LDCCOTITRREAP','LDCLMLE','P_CORRECCION_REVISION_PERIODICA_100349','LDCTIPOCARDIF','CCGSCM','LDC_AIU','CNCRMNG','LDCGPAPR','LDCINFOGESMOV','LDC_INSERTITEMSMASIVO','LDCCR','CAVSI','LDC_PERABOPRO','LDCAUP','P_LDC_CAMBIO_DE_ESTADO_100287','LDPGS','PTTAA','FDCPC','LDSPO','LDCCONUNHI','LDCORF','PBACUCARTOTK','LDC_TIPONOVEDAD','GEPER','LDC_FIFCAST','LDCOIACLEG','LDC_MD_RESUINSP','LDADA','P_SOLICITUD_DE_DUPLICADO_100212','LDCCFNAC','LDC_MAGRUPLOCA','LDCCERS','P_LDC_APLICACION_ASISTIDA_DE_DEPOSITO_100353','P_TRAMITE_DE_VENTA_100236','LDCAPB','LDPECBF','RUORD','LDDPS','FIDCS','LDORANPU','LDDPC','LDCCONPR','GEPBA','FNBIR','FIRTC','FIHOS','LDC_DLRCLPB','LDCAROSF','OFRT','LDCPROVCART','LDCMOSACA','LDC_CAUABOFNB','LDC_ACTESCUREPORTECART','FIAPR','CRGNC','FMNCR','LDPSE','LDCCONCPRO','LDCCODA','LDCCBL','FIEPC','LDCTSV','LDCSC','LDCSPU','LECTESPCNL','LDRRANOPA','LDSEC','GENORDPER','LDCUCESP','LDCVALREPS','LDCTNTRTF','LDCRESSUI','LDCCCRCS','LDCCCESP','PBAC','LDCREUSCO','LDCRUTCONT','VENPS','LDUSPR','LDC_PBREGCONT','LDCCONUSCAST','LDCIC','LDCLEGOTLEC','LDTCFA','LDC_CTCUCC','LDCGPVANU','LDSUBSI','LDVALREC','GCTSR','GCCSR','LDCSUPSXVAL','LDCGRCI','LDCINFAUD','LDCPECIER','LDCCOTTPRO','LDCAPS','LDCCEN','LDC_MAGRUPO','LDCCOTICACAUS','LDCASOOTVECR','NIVELRIESGO','LDCCAUSSSPD','P_CAMBIO_DE_CONSECUTIVO_100234','FEQUC','P_SOLICITUD_DE_CAMBIO_A_PREPAGO_100382','LDDRC','LDCPRACCA','LDCDAGECJ','LDC_GOC','PBPGC','MDLGX','COVCM','LDCCAMASO','LDCTSSSPD','LDCIPLI','LDCUPIPLI','LDBEX','LDCFSEC','LDCIOFICVENT','GEITS','LDCMC','LDCUE','P_SOLICITUD_DE_NO_RENOVACIOM_100242','FNBCR','LDCGNTTP','LDC_CAMBESTDLIC','P_MARCACION_DE_CLIENTES_TIPO_DE_VIVIENDA_100368','LDCCSC','LDCI_REVERPROVCOST','FCUAD','LDCINCHO','AJORLAB','LDCIMMT','LDCGAS','DLRESPOPB','LDCDESCRINDI','PBRHG','LDCMENEXOG','LDCCAUC','LDCCREEX','LDCEQLOC','LDCCCOEX','LDCGCAUC','LDC_MADAVEING','LDCCONFPLCO','LDCCMC','LDC_PERFILUSUARIOS','P_GESTION_DE_TUTELAS_100205','LDCMAIL','LDCFCCA','LDCCDVALEOT','LDC_CTRACC','ARTE','LDCCPDC','LDCCPCE','LDCIEC','P_LDC_SOLICITUD_DE_RECONEXION_ADMINISTRATIVA_100346','LDCIMP','LDCCNCOR','LDCVP','CONCPLANC','LDCCANVSIF','LDCMOSO','LDCCACASU','LDCCONFORDEMAIL','FCBOG','LDCMATERIALES','LDCRESINSPEC','OCETI','OCENO','LDUPS','LDSUS','LDMGEO','LDCUOSUP','LDCUNODOI','LDCUNIDDEC','LDCUD','LDCUC','LDCUB','LDCUA','LDCTITRDOCU','LDCTIRESSPD','LDCTIPTRA','LDCTIPOZONA','LDCTIPOLISTA','LDCTIPOFER','LDCTIPODIAMETRO','LDCTIPLOCUNI','LDCMDTIPORED','LDCMACPCC','LDCLV','LDCCOMBSOL','LDCIMOTIPEDI','LDCIMOTIDEPE','LDCIMOTIDEMA','LDCGRUPROD','LDCGRUCAUS','LDCGRUCAT','LDCGCTITA','LDCCVAT','LDCCRPCAT','LDCCOAUPRP','LDCCFCTSA','LDCBSCTM','LDCBSCPRO','LDCACTULISCOS','LDC_MACOMCTT','GEUSAFMACO','GEMCLU','FPCT','FMUMM','FIDDP','FCCNA','CPEC','CPCXC','CMAOTA','LDCTIPME','LDCCCXDP','LDCREVEING','LDC_APUSSOTECO','P_RECONEXION_POR_CALIDAD_DE_MEDICION_100331','LDC_PBTRASINFOCLIENT','LDC_PBCAMBIODIRORDEN','LDC_FMVM','LDCTIPOENER','LDCFIACE','P_SOLICITUD_DE_ANULACION_DE_VENTA_SIN_PAGO_DE_CUOTA_INICIAL_100327','LDCSNATT','LDCIREPINTCONTL','LDCACP','UPSOLICITANTE','LDCTAIS','LDCMAEJCA','LDCRVEEM','P_SOLICITUD_SAC_INSTALACIONES_INTERNAS_100307','LDC_ALT','PROGVIV','LDCIDO','LDCCRELISCOS','LDGIC','LDCINGCEI','GEUSSFMLE','GEUSSFMACO','LDCAVR','LDCI_PVCM','LDRECUS','P_VERIFICACION_SOLICITUD_SAC_RP_100355','LDCSCL','LDPRES','LDCCARTIPORED','P_SOLICITUD_DE_CUPON_POR_EL_PORTAL_WEB_100336','LDC_PROCCOSTINGR','LDCIINGCLA','P_VERIFICACION_SAC_RP_100330','LDCCCDI','LDCPAC','LDRAV','P_APLICACION_ASISTIDA_DE_DEPOSITO_100238','P_LDC_SOLICITUD_ANULACION_PAGARE_UNICO_100280','LDURNS','LDCMARCTITRCAUS','P_RECONEXION_TEMPORAL_100255','GEUSAFMLE','LDDBS','LDRSS','LDGLS','LDCMOPL','LDIMPMAS','LDCVEFM','FGCPCM','LDCRELPNO','IENCO','PBDESNO','LDC_DIASHPACKTYPE','MDGKI','LEMADOPA','LODPDT','GECPA','LDCAC','LDHOCA','LDCCONFVPCDSI','FMTICC','CONFCAMPFNB','LDCGF','LDCCOUSOSERV','P_SOLICITUD_RECURSO_DE_REPOSICION_XML_100337','LDCIMCUPT','LDCCOPEEPCO','LDCCOLODIGE','LDCCOVEDELOSE','FIAC','P_VENTA_DE_GAS_POR_FORMULARIO_MIGRACION_100271','LDINS','LDIBO','GEDAC','P_VENTA_SERVICIOS_FINANCIEROS_100219','PR','OMNO','CERPLA','LDCDBS','LDCBLOCACAT','LDCICTAPAG','LDCIITEMCO','LDCILOCCOI','LDCIGINT','LDCIGINTMES','LDCINTPROCOS','LDCINTREPROV','CPICA','CCICA','CONRT','PVORP','PBCS','P_IMPRESION_DE_DUPLICADO_100215','P_MODIFICACION_A_SOLICITUD_DE_ACTUALIZACION_CLIENTE_A_CONTRATO_100223','P_VENTA_FNB_100264','P_TRAMITE_VENTA_SEGUROS_XML_100261','P_CANCELACION_DE_SEGUROS_XML_100266','CMCR','PR_SERVICIOS_FINANCIEROS_PROMIGAS_7056','CMDR','P_REGISTRO_OBJECI_N_DEL_CLIENTE_POR_FALLO_DE_PLIEGO_DE_CARGOS_100208','PBRRC','P_VENTA_DE_GAS_POR_FORMULARIO_XML_100233','P_LDC_INVESTIGACIONPORDESACATO_100217','FGMD','FMDAER','GEAPB','ELEX','PR_SERVICIOS_FINANCIEROS_7055','PR_BRILLA_SEGURO_7053','FMTBV','LDALS','GEEMP','OBJECT_PROCESS_500000000000285','P_SOLICITUD_DE_VISITA_FINANCIACIONES_NO_BANCARIAS_XML_100245','P_DEVOLUCION_DE_ARTICULOS_A_PROVEEDOR_100243','P_ANULACION_DE_FINANCIACION_DE_ARTICULOS_A_PROVEEDORES_100244','LDRDS','CMIFV','OBJECT_PROCESS_500000000000643','GDCRE','CTARF','OCRT_COPIA','CMUBR','CMUGR','CONS_ADDITIONAL_DATA_500000000001279','LDCTV','LDEFC','LDICP','CZOFE','CFID','CONLOG','GSDC','FMTB','CEVAPLA','OORCE','OTICE','OMTI','ICCAUS','ICELEM','ICLORE','ICREPP','ICSUEL','ICTIEV','ICSEEL','ICMAEL','ICELMA','ICELLO','FMLGC','CLAER','VACELAB','CETIPLAB','PCOMER','OCRT','LDCEADC','ICDIRO','PR_GNCV_7052','TTNOLI','LDAMA','LDCMESTRUSO','LDCICLIND','LDCPRITIPR','LDCCONGESCOBR','ITEXTSHARP','P_LDC_PAZ_Y_SALVO_NO_FINANCIADOS_100247','P_REGENERACION_DE_REVISION_PERIODICA_100253','LDCRATP','P_VENTA_PROMIGAS_XML_100218','CONS_ADDITIONAL_DATA_500000000002508','LDCBER','GEPPB','FCAP','LDCTEFAM','CMDPP','CANPC','LDCREVPM','LDCICNIC','FCUD','FPPL','CEDR','LDCCIS','PPFNB','LDCTAB','LDCINTACTAS','LDCIREVCLACART','AOPCA','OBJECT_PROCESS_500000000002363','CPFNB','LDCIREVCLACARTRO','OBJECT_PROCESS_500000000003305','P_LDC_VERIFICACION_DE_DEFECTOS_REPORTADOS_POR_OIA_100248','ORITC','P_NOTIFICACION_SUSPENSION_X_AUSENCIA_DE_CERTIFICADO_100246','LDCPAMM','OBJECT_PROCESS_500000000002490','FMPPP','P_SOLICITUD_PROTECCION_DATOS_PERSONALES_100252','NOTICAL','PBAIS','CONFGLOBAL','FMCUO','P_ASOCIA_OTS_AUTONOMAS_DE_CONSTRUCCION_100269','LDCPDP','LDCICECOTR','LDCINTCONSUMO','LDCIREPLICACECO','LDCAS','LDCPA','LDCCRE','CONS_ADDITIONAL_DATA_500000000002588','PGPPC','LDISU','LDREM','LDASR','LDLTP','DLRUSEX','P_LDC_SOLICITUD_DE_VISITA_RECONEXION_TEMPORAL_X_RP_100235','LDCIREPOACTA','LDCIACLOTITR','LDCIMINCON','EQUILAB','LDCACE','PBOTC','LDCCAR','P_LDC_VISITA_VENTA_GAS_XML_100268','CTCVE','DLRIGCV','LDCVE','ILEFAE','LDCCT','LDRQS','PR_OTROS_SERVICIOS_FINANCIEROS_7054','LDCANOTPER','RUTEROS','LDC_PROCPVCO','LDCMEX','LDCGENCAR','APROREPOAT','LDCCEQ','LDCIPROVINGRERO','RUTEROSCRM','LDCPI','P_LDC_REINSTALAR_EVACUADOS_100274','LDCCEC','LDCPAA','P_LDC_SOLICITUD_EVACUADOS_100273','LDC_NOCODE','P_FORMULARIO_IFRS_100249','P_INTERNA_IFRS_100259','P_COTIZADA_IFRS_100272','LDIBL','FIACS','PBEQU','P_GENERACION_SOLICITUD_DEFECTO_CRITICO_100293','LDCVACT','LDCESSSPD','LDCCONSUFI','LDCMERESSPD','LDLQS','FIACE','P_SOLICITUD_SAC_100329','FMAREG','LDCARCO','LDCPFORE','FIACM','LDCEMI','HIVAFACO','CONS_ADDITIONAL_DATA_500000000012557','LDCRDC','LDCCAMAAD','P_ACTUALIZACION_DATOS_CLIENTE_XML_CAMPANA_100318','FIUTC','LDAPB','OBJECT_PROCESS_500000000012040','FGCHC','FCDCRG','LDCCUOGC','P_CAMBIO_TIPO_SUSPENSION_A_RP_100312','P_CAMBIO_DE_PLAN_DE_COMERCIAL_POR_XML_100298','LDCPAAP','OBJECT_PROCESS_500000000012031','LDCPSC','P_REGISTRO_DE_DANO_A_PRODUCTO_POR_XML_100339','LDCCAINFA','LDCCCGC','LDCCFLCLC','LDCCOREFC','LDC_FTABLE','LDCDESCAST','LDC_PROCMGCTT','LDCTVALDUP','LDCAMAM','IRMFE','LDACRE','OBJECT_PROCESS_500000000014145','OBJECT_PROCESS_500000000006434','P_SOLICITUD_DUPLICADO_KIOSCO_100342','LDCCOTTSRTIRP','ORCONO','OBJECT_PROCESS_500000000013514','OBJECT_PROCESS_500000000013515','OBJECT_PROCESS_500000000013516','LDCSCC','P_CORRECCION_DE_DATOS_POR_XML_100296','P_VENTA_DE_ESTUFA_100322','P_SOLICITUD_DE_INFORMACION_PUBLICA_100332','P_ACTM_100278','LDCMTS','LDCGLQ','LDCGRQ','LDCPTQ','LDCTRF','LDCFACTQUIN','VPPPR','OBJECT_PROCESS_500000000006526','LDEMAIL','P_RECONEXION_DE_SERVICIOS_NUEVOS_100305','P_SUSPENSION_DE_SERVICIOS_NUEVOS_100309','LDCEPU','P_LDC_SOLICITUD_PAGARE_UNICO_100279','IMPCPS','LDCREMP','CCCBR','CCSAC','CCCSC','LDCTIPNOT','LDCAAN','LDCRA','OBJECT_PROCESS_500000000015178','VCAMDVPM','P_CANCELACION_DE_TARIFA_TRANSITORIA_100347','CAMPFNB','P_VENTA_DE_GAS_POR_FORMULARIO_XML_PLAN_COMERCIAL_ESPECIAL_100354','LDCIMCG','P_RECARGA_PREPAGO_100381','LDCBDOSF','LDC_PROCCONUNI','LDC_PROCINCLUSCOUN','LDCPREUNCO','IMPDF','P_SOLICITUD_SERVICIOS_EXEQUIALES_XML_100352','P_SOLICITUD_SAC_DE_SEGUROS_100361','INFOSUBSIDIO','PBASV','P_SUSPENSION_POR_SEGURIDAD_XML_100334','P_RECONEXION_POR_SEGURIDAD_100343','LDCCVCR','OBJECT_PROCESS_500000000015722','LDCANM','LDCPE','LDCLCTOICL','P_LDC_SOLICITUD_RECLAMOS_100335','P_SOLICITUD_REPOSICION_EN_SUBSIDIO_DE_APELACION_100338','LDCITEMN','LDCCAIPA','P_LDC_INFORMACION_DE_DESBLOQUEO_DE_ORDENES_100366','CLPR','CMPP','FMJAC','MDES','PBNCM','FAMA','P_SOLICITUD_DE_TRASLADAR_DIFERIDO_A_PRESENTE_MES_POR_EL_PORTAL_WEB_100340','P_SUSPENSION_POR_CALIDAD_DE_MEDICION_100328','FPMFE','FPMIC','LDCCUS','P_CAMBIO_TITULAR_PORTAL_WEB_100315','P_REGISTRO_DE_COMPENSACION_100367','LDCJARRE','LDCNODEU','P_REGISTRO_PAGO_MEDIOS_ELECTRONICOS_100311','LDCOCC','LDCRCC','LDCRGCC','LDCATA','LDCGCC','ANULVC','P_RETENCION_DE_SEGUROS_100311','P_LDC_ACEPTA_REPARACIONES_100348','LDCGESCONFPORP','LDC_MD_DESCMATERIALES','LDC_MD_DESCRIPINDI','LDC_MDTTMATDIAZONA','LDCPAGOORDRP','P_SOLICITUD_DE_CANCELACION_DE_SUSCRIPCION_FACTURA_POR_CORREO_ELECTRONICO_100275','LDCGI','PBINFOAUDITORIA','P_RTR_PREPAGO_100379','LDCAESCO','P_REGISTRO_PQR_PORTAL_WEB_100284','P_LDC_RETENCION_SEGUROS_100291','LD_CAGTEC','P_ACTIVIDADES_PARA_GESTION_TECNICA_100286','P_FINANCIACION_EFISOLUCIONES_100292','LDSUBS','LDC_CONFORDPNO','FACTDUPLI','LDCELCIOSIS','P_LDC_REGISTRO_DE_DANO_A_PRODUCTO_100282','LDCCFECE','P_SOLICITUD_SERVICIOS_EXEQUIALES_XML_100285','LDCCAMPAIGN','P_RETENCION_DE_SEGUROS_100276','CERLABFIRM','P_CAMBIO_TITULAR_PORTAL_WEB_100293','LDCMENRP','LDCIREPSAPA','LDCCHORPE')
),
formas AS
(SELECT distribution_file_id, CASE WHEN es_programable='Y' THEN distribution_file_id ELSE decode(instr(proceso,'.'),0, proceso, substr(proceso,1,instr(proceso, '.')-1)) END objeto
FROM formas_pb )
,
OBJETOS_BD as(select distinct objeto 
from formas), 
DEPENDENCIAS AS(
SELECT D.name, D.TYPE, D.REFERENCED_NAME, D.REFERENCED_TYPE
FROM DBA_DEPENDENCIES D 
WHERE D.OWNER='OPEN'
 AND D.name!=D.REFERENCED_NAME
 AND REFERENCED_OWNER='OPEN'
 AND REFERENCED_TYPE NOT IN ('TABLE', 'VIEW','SEQUENCE','TYPE')
 AND TYPE!='PACKAGE'),
DEPENDENCIAS1 AS (
SELECT B.OBJETO, D.REFERENCED_NAME, D.REFERENCED_TYPE
FROM OBJETOS_BD B, DEPENDENCIAS D 
WHERE  D.name=B.OBJETO (+)),
DEPENDECIAS2 AS(
SELECT D1.OBJETO,
       D1.REFERENCED_NAME nivel1,
       D1.REFERENCED_TYPE tipo1,
       D2.REFERENCED_NAME nivel2,
       D2.REFERENCED_TYPE tipo2
FROM DEPENDENCIAS1 D1,
DEPENDENCIAS D2 
WHERE D2.NAME=D1.REFERENCED_NAME(+)),
total_final as(
SELECT f.distribution_file_id forma,
       f.objeto,
       d.nivel1,
       d.tipo1,
       d.nivel2,
       d.tipo2,
       row_number() over ( partition by distribution_file_id order by distribution_file_id) filas
from formas f,
DEPENDECIAS2 d
where f.objeto=d.objeto),
total as(
select d.forma,
       CASE WHEN filas=1 THEN (SELECT MAX(S.LINE) FROM dba_source S WHERE S.OWNER='OPEN' AND S.NAME=d.objeto) ELSE 0 END lineas,
       nivel1,
       CASE WHEN (SELECT COUNT(1) FROM OBJETOS_PRODUCTO P WHERE P.NOMBRE=nivel1 AND D.tipo1=P.TIPO) >0 THEN 0 
            ELSE (SELECT MAX(S.LINE) FROM DBA_SOURCE S WHERE S.OWNER='OPEN' AND S.name=nivel1 ) END LINEAS2,
       (SELECT COUNT(1) 
        FROM dba_dependencies d1 
        WHERE d1.referenced_type NOT IN ('TABLE', 'VIEW','SEQUENCE')
         AND D1.TYPE!='PACKAGE'
         AND d1.referenced_owner IN ('OPEN', 'ADM_PERSON', 'PERSONALIZACIONES')
          AND D.nivel2 = d1.NAME
          AND D1.REFERENCED_NAME!=D1.NAME
          ) cant_refe2
from total_final d)
SELECT forma, SUM(LINEAS+LINEAS2) lineas, SUM(CANT_REFE2)+COUNT(nivel2) cant_referencias
FROM total
group by rollup(forma)
