
CREATE OR REPLACE PACKAGE BODY GC_UICASTIGOCARTERAPR IS
   CSBVERSION CONSTANT VARCHAR2( 250 ) := 'SAO183946';
   CNUZERO CONSTANT NUMBER := PKBILLCONST.CERO;
   CNUNULL_ATTRIBUTE CONSTANT NUMBER := 2126;
   CNUNOTEXIST_PROJECT CONSTANT NUMBER := 901015;
   CNUFINISHEDPROJECT CONSTANT NUMBER := 901016;
   CNUINVALIDSTATEPROJECT CONSTANT NUMBER := 300330;
   CNUNOTEXIST_DEUDA CONSTANT NUMBER := 900565;
   CSBUNFINISHED_PROJECT CONSTANT GC_PROYCAST.PRCAESTA%TYPE := 'P';
   CNUFINISHED_PROJECT CONSTANT GC_PROYCAST.PRCAESTA%TYPE := 'T';
   CSBCASTAPPNAME CONSTANT VARCHAR2( 5 ) := 'CASCA';
   ONUERRORCODE NUMBER;
   SBERRMSG GE_ERROR_LOG.DESCRIPTION%TYPE;
   SBESTAPROG ESTAPROG.ESPRPROG%TYPE;
   FUNCTION FSBVERSION
    RETURN VARCHAR2
    IS
    BEGIN
      RETURN CSBVERSION;
   END FSBVERSION;
   PROCEDURE PROCASTIGOCARTERAPROY
    IS
      RCPROGRAMACION DAGE_PROCESS_SCHEDULE.STYGE_PROCESS_SCHEDULE;
      PROCEDURE ADDPARAMPROGRAM( RCPROGRA OUT DAGE_PROCESS_SCHEDULE.STYGE_PROCESS_SCHEDULE )
       IS
         SBUSUARIOBD VARCHAR2( 100 );
         SBCONTRASENABD VARCHAR2( 100 );
         SBINSTANCIABD VARCHAR2( 100 );
         SBCONEXION VARCHAR2( 1000 );
         NUPROGRAMACION GE_PROCESS_SCHEDULE.PROCESS_SCHEDULE_ID%TYPE;
         CSBSEPARADOR CONSTANT VARCHAR2( 1 ) := '|';
         CSBPARAMCONEXION CONSTANT GE_PROCESS_SCHEDULE.PARAMETERS_%TYPE := 'CONEX=';
       BEGIN
         PKERRORS.PUSH( 'GC_UICastigoCarteraPr.ProCastigoCarteraProy.AddParamProgram' );
         NUPROGRAMACION := GE_BOSCHEDULE.FNUGETSCHEDULEINMEMORY;
         RCPROGRA := DAGE_PROCESS_SCHEDULE.FRCGETRECORD( NUPROGRAMACION );
         GE_BODATABASECONNECTION.GETCONNECTIONSTRING( SBUSUARIOBD, SBCONTRASENABD, SBINSTANCIABD );
         SBCONEXION := SBUSUARIOBD || '/' || SBCONTRASENABD || '@' || SBINSTANCIABD;
         SBCONEXION := BI_BOSERVICIOSDOTNET.FSBCODIFICARCONTRASENA( SBCONEXION );
         RCPROGRA.PARAMETERS_ := RCPROGRA.PARAMETERS_ || CSBPARAMCONEXION || SBCONEXION || CSBSEPARADOR;
         PKERRORS.POP;
       EXCEPTION
         WHEN LOGIN_DENIED OR PKCONSTANTE.EXERROR_LEVEL2 THEN
            PKERRORS.POP;
            RAISE EX.CONTROLLED_ERROR;
         WHEN EX.CONTROLLED_ERROR THEN
            PKERRORS.POP;
            RAISE EX.CONTROLLED_ERROR;
         WHEN OTHERS THEN
            PKERRORS.POP;
            ERRORS.SETERROR;
            RAISE EX.CONTROLLED_ERROR;
      END;
      PROCEDURE UPDPARAMPROGRAM( RCPROGRA IN DAGE_PROCESS_SCHEDULE.STYGE_PROCESS_SCHEDULE )
       IS
       BEGIN
         PKERRORS.PUSH( 'GC_UICastigoCarteraPr.ProCastigoCarteraProy.UpdParamProgram' );
         DAGE_PROCESS_SCHEDULE.UPDRECORD( RCPROGRA );
         PKGENERALSERVICES.COMMITTRANSACTION;
         PKERRORS.POP;
       EXCEPTION
         WHEN LOGIN_DENIED OR PKCONSTANTE.EXERROR_LEVEL2 THEN
            PKERRORS.POP;
            RAISE EX.CONTROLLED_ERROR;
         WHEN EX.CONTROLLED_ERROR THEN
            PKERRORS.POP;
            RAISE EX.CONTROLLED_ERROR;
         WHEN OTHERS THEN
            PKERRORS.POP;
            ERRORS.SETERROR;
            RAISE EX.CONTROLLED_ERROR;
      END;
    BEGIN
      PKERRORS.PUSH( 'GC_UICastigoCarteraPr.ProCastigoCarteraProy' );
      ADDPARAMPROGRAM( RCPROGRAMACION );
      UPDPARAMPROGRAM( RCPROGRAMACION );
      PKERRORS.POP;
    EXCEPTION
      WHEN LOGIN_DENIED OR PKCONSTANTE.EXERROR_LEVEL2 THEN
         PKERRORS.POP;
         RAISE EX.CONTROLLED_ERROR;
      WHEN EX.CONTROLLED_ERROR THEN
         PKERRORS.POP;
         RAISE EX.CONTROLLED_ERROR;
      WHEN OTHERS THEN
         PKERRORS.POP;
         ERRORS.SETERROR;
         RAISE EX.CONTROLLED_ERROR;
   END PROCASTIGOCARTERAPROY;
END GC_UICASTIGOCARTERAPR;
/


