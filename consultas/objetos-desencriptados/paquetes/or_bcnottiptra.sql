
CREATE OR REPLACE PACKAGE BODY OR_BCNOTTIPTRA IS
   CSBVERSION CONSTANT VARCHAR2( 250 ) := 'SAO117569';
   FUNCTION FSBVERSION
    RETURN VARCHAR2
    IS
    BEGIN
      RETURN CSBVERSION;
   END;
   FUNCTION FNUNOTIFPORTIPOTRABA( INUTASKTYPEID IN OR_TASK_TYPE.TASK_TYPE_ID%TYPE )
    RETURN NUMBER
    IS
      NUNOTIFICATIONID GE_NOTIFICATION.NOTIFICATION_ID%TYPE;
      CURSOR CUNOTIFICACION( NUTASKTYPEID IN OR_TASK_TYPE.TASK_TYPE_ID%TYPE ) IS
SELECT id_notificacion
            FROM   or_notif_tipo_traba
            WHERE  id_tipo_trabajo = inuTaskTypeId;
    BEGIN
      UT_TRACE.TRACE( 'Inicia or_bcNotTipTra.fnuNotifPorTipoTraba', 2 );
      IF ( CUNOTIFICACION%ISOPEN ) THEN
         CLOSE CUNOTIFICACION;
      END IF;
      OPEN CUNOTIFICACION( INUTASKTYPEID );
      FETCH CUNOTIFICACION
         INTO NUNOTIFICATIONID;
      CLOSE CUNOTIFICACION;
      UT_TRACE.TRACE( 'Finaliza or_bcNotTipTra.fnuNotifPorTipoTraba', 2 );
      RETURN NUNOTIFICATIONID;
    EXCEPTION
      WHEN EX.CONTROLLED_ERROR THEN
         IF ( CUNOTIFICACION%ISOPEN ) THEN
            CLOSE CUNOTIFICACION;
         END IF;
         UT_TRACE.TRACE( 'CONTROLLED_ERROR or_bcNotTipTra.fnuNotifPorTipoTraba', 2 );
         RAISE EX.CONTROLLED_ERROR;
      WHEN OTHERS THEN
         IF ( CUNOTIFICACION%ISOPEN ) THEN
            CLOSE CUNOTIFICACION;
         END IF;
         UT_TRACE.TRACE( 'OTHERS or_bcNotTipTra.fnuNotifPorTipoTraba', 2 );
         ERRORS.SETERROR;
         RAISE EX.CONTROLLED_ERROR;
   END FNUNOTIFPORTIPOTRABA;
END OR_BCNOTTIPTRA;
/


