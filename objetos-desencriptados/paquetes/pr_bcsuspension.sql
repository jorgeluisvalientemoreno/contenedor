PACKAGE PR_BCSUSPENSION AS





























    
    
    
    
    
















    CURSOR CUPRODSUPENSION
    (
        INUPRODUCTID        IN PR_PROD_SUSPENSION.PRODUCT_ID%TYPE,
        INUSUSPENSIONTYPEID IN PR_PROD_SUSPENSION.SUSPENSION_TYPE_ID%TYPE
    )
    IS
        SELECT A.*, A.ROWID
        FROM PR_PROD_SUSPENSION A
        WHERE A.PRODUCT_ID = INUPRODUCTID
            AND A.SUSPENSION_TYPE_ID =  NVL(INUSUSPENSIONTYPEID,A.SUSPENSION_TYPE_ID)
            AND A.ACTIVE = GE_BOCONSTANTS.CSBYES;
            
            
    
















    CURSOR CUCOMPSUPENSION
    (
        INUCOMPONENTID      IN PR_PROD_SUSPENSION.PRODUCT_ID%TYPE,
        INUSUSPENSIONTYPEID IN PR_PROD_SUSPENSION.SUSPENSION_TYPE_ID%TYPE
    )
    IS
       SELECT A.*, A.ROWID
         FROM PR_COMP_SUSPENSION A
        WHERE A.COMPONENT_ID = INUCOMPONENTID
          AND A.SUSPENSION_TYPE_ID = NVL(INUSUSPENSIONTYPEID, A.SUSPENSION_TYPE_ID)
          AND A.ACTIVE = GE_BOCONSTANTS.CSBYES;


    














    CURSOR CUVALIDSUSPBYPRODUCT
    (
        INUPRODUCTID        IN  PR_PROD_SUSPENSION.PRODUCT_ID%TYPE,
        INUPRODUCTTYPEID    IN  PR_PRODUCT.PRODUCT_TYPE_ID%TYPE,
        ISBSUSPCLASS        IN  GE_SUSPENSION_TYPE.CLASS_SUSPENSION%TYPE
    )
    IS
        SELECT A.SUSPENSION_TYPE_ID,A.DESCRIPTION
        FROM GE_SUSPENSION_TYPE A , PS_SUSTYP_BY_PROTYP B
        WHERE B.PRODUCT_TYPE_ID = INUPRODUCTTYPEID
            AND CLASS_SUSPENSION = ISBSUSPCLASS
            AND A.SUSPENSION_TYPE_ID=B.SUSPENSION_TYPE_ID
            AND NOT EXISTS
            (
                SELECT 1
                FROM PR_PROD_SUSPENSION
                WHERE PRODUCT_ID = INUPRODUCTID
                        AND SUSPENSION_TYPE_ID = A.SUSPENSION_TYPE_ID
                        AND ACTIVE = GE_BOCONSTANTS.GETYES
            );

    



















    CURSOR CUGETSUSPTYPEBYPROD
    (
        INUPRODUCTID        IN  PR_PROD_SUSPENSION.PRODUCT_ID%TYPE,
        INUPRODUCTTYPEID    IN  PR_PRODUCT.PRODUCT_TYPE_ID%TYPE,
        ISBSUSPCLASS        IN  GE_SUSPENSION_TYPE.CLASS_SUSPENSION%TYPE
    )
    IS
        SELECT  /*+ ordered
                    index(c IX_PR_PROD_SUSPENSION05)
                    index(a PK_GE_SUSPENSION_TYPE)
                    index(b PK_PS_SUSTYP_BY_PROTYP) */
                A.SUSPENSION_TYPE_ID, A.DESCRIPTION
        FROM    PR_PROD_SUSPENSION C, GE_SUSPENSION_TYPE A, PS_SUSTYP_BY_PROTYP B
        WHERE   A.SUSPENSION_TYPE_ID = B.SUSPENSION_TYPE_ID
          AND   A.SUSPENSION_TYPE_ID = C.SUSPENSION_TYPE_ID
          AND   C.ACTIVE = GE_BOCONSTANTS.GETYES
          AND   C.PRODUCT_ID = INUPRODUCTID
          AND   B.PRODUCT_TYPE_ID = INUPRODUCTTYPEID
          AND   A.CLASS_SUSPENSION = ISBSUSPCLASS;

    














    CURSOR CUSUSPACTBYPRDANDCLA
    (
        INUPRODUCTID        IN  PR_PROD_SUSPENSION.PRODUCT_ID%TYPE,
        ISBSUSPCLASS        IN  GE_SUSPENSION_TYPE.CLASS_SUSPENSION%TYPE
    )
    IS
        SELECT A.SUSPENSION_TYPE_ID,A.DESCRIPTION
        FROM GE_SUSPENSION_TYPE A , PR_PROD_SUSPENSION C
        WHERE   C.PRODUCT_ID         = INUPRODUCTID
            AND A.CLASS_SUSPENSION   = ISBSUSPCLASS
            AND C.SUSPENSION_TYPE_ID = A.SUSPENSION_TYPE_ID
            AND C.ACTIVE             = GE_BOCONSTANTS.GETYES;

    















    CURSOR CUSUSPVOLBYRANGE (INUPRODUCTID      IN PR_PRODUCT.PRODUCT_ID%TYPE,
                             IDTINSTALL     IN DATE,
                             IDTEXPIRATION  IN DATE) IS
        SELECT  A.*, A.ROWID
        FROM    PR_PROD_SUSPENSION A
        WHERE   ( (A.APLICATION_DATE >= IDTINSTALL AND A.INACTIVE_DATE <=  IDTEXPIRATION)
                  OR
                  (A.APLICATION_DATE <  IDTINSTALL AND A.INACTIVE_DATE >  IDTINSTALL)
                  OR
                  (A.APLICATION_DATE <  IDTEXPIRATION AND A.INACTIVE_DATE >  IDTEXPIRATION)
                  OR
                  (A.APLICATION_DATE >=  IDTINSTALL AND A.APLICATION_DATE <  IDTEXPIRATION  AND A.INACTIVE_DATE IS NULL) 
                  OR
                  (A.APLICATION_DATE < IDTINSTALL  AND A.INACTIVE_DATE IS NULL) )
        AND     A.PRODUCT_ID      =  INUPRODUCTID
        AND     A.SUSPENSION_TYPE_ID IN (PR_BOPARAMETER.FNUGETBI_VOL_SUSPENSION,
                                         PR_BOPARAMETER.FNUGETIN_VOL_SUSPENSION,
                                         PR_BOPARAMETER.FNUGETOU_VOL_SUSPENSION);

            
    
    
    
    



    FUNCTION FSBVERSION  RETURN VARCHAR2;

    















    FUNCTION FRFCOMPSUSPENSION
    (
        INUCOMPONENTID  IN PR_COMPONENT.COMPONENT_ID%TYPE,
        IDTINACTIVEDATE IN DATE
    )
    RETURN CONSTANTS.TYREFCURSOR;

    












    FUNCTION FRFCOMPSUSPENSION
    (
        INUCOMPONENTID  IN PR_COMPONENT.COMPONENT_ID%TYPE
    )
    RETURN CONSTANTS.TYREFCURSOR;

    












    FUNCTION FRFPRODSUSPENSION
    (
        INUPRODUCTID  IN PR_PRODUCT.PRODUCT_ID%TYPE
    )
    RETURN CONSTANTS.TYREFCURSOR;
    
    














    FUNCTION FRFPRODSUSPENSION
    (
        INUPRODUCTID  IN PR_PRODUCT.PRODUCT_ID%TYPE,
        IDTINACTIVEDATE IN DATE
    )
    RETURN CONSTANTS.TYREFCURSOR;
    
    













    
    FUNCTION FRFPRODSUSPENSIONBYYEAR
    (
       INUPRODUCTID  IN PR_PRODUCT.PRODUCT_ID%TYPE,
       IDTREQUESTDATE IN DATE
    )
    RETURN CONSTANTS.TYREFCURSOR;
    
    
    













    FUNCTION FRCGETPRODSUSP
    (
        INUPRODUCTID    IN      PR_PROD_SUSPENSION.PRODUCT_ID%TYPE,
        INUSUSPTYPEID   IN      PR_PROD_SUSPENSION.SUSPENSION_TYPE_ID%TYPE
    )
    RETURN DAPR_PROD_SUSPENSION.STYPR_PROD_SUSPENSION;
    
    
    













    FUNCTION FRCGETCOMPSUSP
    (
        INUCOMPONENTID  IN      PR_COMP_SUSPENSION.COMPONENT_ID%TYPE,
        INUSUSPTYPEID   IN      PR_COMP_SUSPENSION.SUSPENSION_TYPE_ID%TYPE
    )
    RETURN DAPR_COMP_SUSPENSION.STYPR_COMP_SUSPENSION;
    
    






    FUNCTION FTBGETACTIPRODSUSPS
    (
        INUPRODUCTID        IN  PR_PROD_SUSPENSION.PRODUCT_ID%TYPE,
        INUSUSPENSIONTYPEID IN  PR_PROD_SUSPENSION.SUSPENSION_TYPE_ID%TYPE DEFAULT NULL
    )
    RETURN  DAPR_PROD_SUSPENSION.TYTBPR_PROD_SUSPENSION;
    
    






    FUNCTION FNUCOUNTACTIPRODSUSPS
    (
        INUPRODUCTID        IN  PR_PROD_SUSPENSION.PRODUCT_ID%TYPE,
        INUSUSPENSIONTYPEID IN  PR_PROD_SUSPENSION.SUSPENSION_TYPE_ID%TYPE DEFAULT NULL
    )
    RETURN  NUMBER;
    
    FUNCTION FRFPRODNOREVIEWSUSPENSION
    (
        INUPRODUCTID  IN PR_PRODUCT.PRODUCT_ID%TYPE
    )
    RETURN CONSTANTS.TYREFCURSOR;
    
END PR_BCSUSPENSION;