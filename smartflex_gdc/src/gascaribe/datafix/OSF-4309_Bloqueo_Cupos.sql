column dt new_value vdt
column db new_value vdb
select to_char(sysdate,'yyyymmdd_hh24miss') dt, sys_context('userenv','db_name') db from dual;
set serveroutput on size unlimited
execute dbms_application_info.set_action('APLICANDO DATAFIX');
select to_char(sysdate,'yyyy-mm-dd hh:mi:ss p.m.') fecha_inicio from dual;

declare

	sbCaso				VARCHAR2(30) := 'OSF-4309';
	rcContratosBloqueo	DALD_quota_block.styLD_quota_block;
	
	CURSOR cuContratos
	IS
		SELECT susccodi
		FROM suscripc  
		WHERE susccodi IN (48080940,
							48080941,
							48080942,
							48080943,
							48080944,
							48080945,
							48080946,
							48080947,
							48080948,
							48080949,
							48080950,
							48080951,
							48080952,
							48080953,
							48080954,
							48080955,
							48080956,
							48080957,
							48080958,
							48080959,
							48080960,
							48080961,
							48080962,
							48080963,
							48080964,
							48080965,
							48080966,
							48080967,
							48080968,
							48080969,
							48080970,
							48080971,
							48080972,
							48080973,
							48080974,
							48080975,
							48080976,
							48080977,
							48080978,
							48080979,
							48080980,
							48080981,
							48080982,
							48080983,
							48080984,
							48080985,
							48080986,
							48080987,
							48080988,
							48080989,
							48080990,
							48080991,
							48097835,
							48097836,
							48097837,
							48097838,
							48097839,
							48097840,
							48097841,
							48097842,
							48097843,
							48097844,
							48097845,
							48097846,
							48097847,
							48097848,
							48097849,
							48097850,
							48097851,
							48097852,
							48097853,
							48097854,
							48097855,
							48097856,
							48097857,
							48097858,
							48097859,
							48097860,
							48097861,
							48097862,
							48097863,
							48097864,
							48097865,
							48097866,
							48097867,
							48097868,
							48097869,
							48097870,
							48097871,
							48097872,
							48097873,
							48097874,
							48097875,
							48097876,
							48097880,
							48097881,
							48097882,
							48097883,
							48097884,
							48097885,
							48097886,
							48097887,
							48097888,
							48097889,
							48097890,
							48097891,
							48097892,
							48097893,
							48097894,
							48097895,
							48097896,
							48097897,
							48097898,
							48097899,
							48097900,
							48097901,
							48097902,
							48097903,
							48097904,
							48097905,
							48097906,
							48097907,
							48097908,
							48097909,
							48097910,
							48097911,
							48097912,
							48097913,
							48097914,
							48097915,
							48097916,
							48097917,
							48097918,
							48097919,
							48097920,
							48097921,
							48097922,
							48097923,
							48103205,
							48103206,
							48103207,
							48103208,
							48103209,
							48103210,
							48103211,
							48103212,
							48103213,
							48103214,
							48103215,
							48103216,
							48103217,
							48103218,
							48103219,
							48103220,
							48103221,
							48103222,
							48103223,
							48103224,
							48103225,
							48103226,
							48103227,
							48103228,
							48103229,
							48103230,
							48103231,
							48103232,
							48103233,
							48103234,
							48103235,
							48103236,
							48103237,
							48103238,
							48103239,
							48103240,
							48103241,
							48103242,
							48103243,
							48103244,
							48103245,
							48103246,
							48103247,
							48103248,
							48103249,
							48103250,
							48103251,
							48103252,
							48103253,
							48103254,
							48103255,
							48103256,
							48103257,
							48103258,
							48103259,
							48103260,
							48103261,
							48103262,
							48103263,
							48103264,
							48103265,
							48103266,
							48103267,
							48103268,
							48103269,
							48103270,
							48103271,
							48103272,
							48103273,
							48103274,
							48103275,
							48103276,
							48103277,
							48103278,
							48103279,
							48103280,
							48103281,
							48103282,
							48103283,
							48103284,
							48103285,
							48103286,
							48103287,
							48103288,
							48112820,
							48112821,
							48112822,
							48112823,
							48112824,
							48112825,
							48112826,
							48112827,
							48112828,
							48112829,
							48112830,
							48112831,
							48112832,
							48112833,
							48112834,
							48112835,
							48112836,
							48112837,
							48112838,
							48112839,
							48112840,
							48112841,
							48112842,
							48112843,
							48112844,
							48112845,
							48112846,
							48112847,
							48112848,
							48112849,
							48112850,
							48112851,
							48112852,
							48112853,
							48112854,
							48112855,
							48112856,
							48112857,
							48112858,
							48112859,
							48112860,
							48112861,
							48112862,
							48112863
							);

BEGIN

	dbms_output.put_line('Inicio Datafix OSF-4309');
	
	FOR rcContratos IN cuContratos LOOP
		
		dbms_output.put_line('Creando bloqueo del contrato: ' || rcContratos.susccodi);
			
		-- Llena el registro de los contratos
		rcContratosBloqueo.Quota_Block_Id 	:= SEQ_LD_QUOTA_BLOCK.NEXTVAL;
		rcContratosBloqueo.Block 			:= 'Y';
		rcContratosBloqueo.Subscription_Id 	:= rcContratos.susccodi;
		rcContratosBloqueo.Causal_Id 		:= 130;
		rcContratosBloqueo.Register_Date 	:= LDC_BOCONSGENERALES.FDTGETSYSDATE;
		rcContratosBloqueo.Observation 		:= 'Teniendo en cuenta el reporte recibido desde el canal de grandes superficies, en el cual se sugiere que podría estarse presentando una mala práctica en el edificio ubicado en la TV 44 CL 99C – 70, se realiza el bloqueo de todo el edificio por seguridad, con el fin de evitar que personas que no habiten en los apartamentos tomen los cupos de manera irregular.';
		rcContratosBloqueo.Username			:= PKG_SESSION.GETUSER;
		rcContratosBloqueo.Terminal			:= PKG_SESSION.FSBGETTERMINAL;
		
		DALD_quota_block.insRecord(rcContratosBloqueo);
		
		COMMIT;		
		
	END LOOP;	
	
	dbms_output.put_line('FIN Datafix OSF-4309');
	
END;
/

select to_char(sysdate,'yyyy-mm-dd hh:mi:ss p.m.') fecha_fin from dual;
set serveroutput off
quit
/