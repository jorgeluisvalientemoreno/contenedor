column dt new_value vdt
column db new_value vdb
select to_char(sysdate,'yyyymmdd_hh24miss') dt, sys_context('userenv','db_name') db from dual;
set serveroutput on size unlimited
execute dbms_application_info.set_action('APLICANDO DATAFIX');
select to_char(sysdate,'yyyy-mm-dd hh:mi:ss p.m.') fecha_inicio from dual;

Declare

  cursor cuDiferidos is
    select a.difecodi diferido
      from OPEN.ld_item_work_order a
     where a.order_activity_id in
           (select ooa.order_activity_id
              from open.Or_Order_Activity ooa
             where ooa.package_id in (215694802,
                                      215106778,
                                      215496723,
                                      215710847,
                                      215529290,
                                      215645140,
                                      215496723,
                                      215529290,
                                      214902098,
                                      214902098,
                                      215496723,
                                      215244940,
                                      215182163,
                                      215244940,
                                      215518110,
                                      215645140,
                                      215067415,
                                      215441913,
                                      215418956,
                                      215581034,
                                      215413913,
                                      215581034,
                                      215039788,
                                      215039788,
                                      215582548,
                                      214933254,
                                      215244940,
                                      215320708,
                                      215320708,
                                      214933254,
                                      215669894,
                                      214364403,
                                      215583654,
                                      215356429,
                                      215323036,
                                      215528968,
                                      215356429,
                                      215356429,
                                      215323036,
                                      215400417,
                                      215033893,
                                      215016375,
                                      215610797,
                                      215462529,
                                      215604563,
                                      215033893,
                                      215162719,
                                      215461313,
                                      215598575,
                                      215270338,
                                      215322258,
                                      215437712,
                                      215662308,
                                      215499836,
                                      215583292,
                                      215459651,
                                      215438283,
                                      215583292,
                                      215598989,
                                      214773918,
                                      215387912,
                                      215387912,
                                      215582809,
                                      215582809,
                                      215370594,
                                      215202777,
                                      215270476,
                                      215526627,
                                      215338952,
                                      215030268,
                                      215370594,
                                      215413617,
                                      215030268,
                                      215685172,
                                      215407675,
                                      215307034,
                                      215502343,
                                      215223327,
                                      215502343,
                                      215227213,
                                      214789492,
                                      215101606,
                                      215612203,
                                      215698224,
                                      215131354,
                                      215612438,
                                      214560050,
                                      214906411,
                                      215209149,
                                      215441913,
                                      215480956,
                                      215459651,
                                      215625406,
                                      214190143,
                                      215648302,
                                      214190143,
                                      215563871,
                                      215549316,
                                      215528968,
                                      214562444,
                                      215625725,
                                      215549316,
                                      215612002,
                                      214561686,
                                      214289611,
                                      214560050,
                                      215526382,
                                      215129114,
                                      215326965,
                                      215707564,
                                      215385649,
                                      215223327,
                                      215328070,
                                      214744335,
                                      215644357,
                                      215710627,
                                      215580935,
                                      215366170,
                                      215324984,
                                      215406827,
                                      215671347,
                                      214751317,
                                      215563871,
                                      215481513,
                                      215459651,
                                      215270780,
                                      215235710,
                                      214785426,
                                      214785426,
                                      214991042,
                                      215266601,
                                      215413923,
                                      214991042,
                                      215182163,
                                      215580935,
                                      215623979,
                                      214898122,
                                      215269751,
                                      215419038,
                                      215626081,
                                      215526679,
                                      214826351,
                                      214826351,
                                      215626081,
                                      215107109,
                                      215413088,
                                      215490699,
                                      215310194,
                                      215279966,
                                      215310194,
                                      215401669,
                                      215209149,
                                      215227321,
                                      215482320,
                                      215232586,
                                      215404344,
                                      215370998,
                                      215491737,
                                      215373099,
                                      215461313,
                                      215370998,
                                      215526382,
                                      215411880,
                                      215531234,
                                      215461313,
                                      214780403,
                                      215583328,
                                      215453131,
                                      215516796,
                                      215452666,
                                      215516796,
                                      215432941,
                                      215583328,
                                      215663907,
                                      215452666,
                                      215249875,
                                      215623979,
                                      215661056,
                                      215623979,
                                      215654278,
                                      214563211,
                                      215581602,
                                      215648355,
                                      215648355,
                                      215321108,
                                      215598248,
                                      215239008,
                                      213922928,
                                      215572471,
                                      215558088,
                                      215499380,
                                      215107109,
                                      215670303,
                                      215572471,
                                      215311507,
                                      215526627,
                                      215157717,
                                      215235710,
                                      215581034,
                                      215445452,
                                      215372562,
                                      215157717,
                                      214788672,
                                      214788672,
                                      215481513,
                                      215650961,
                                      215650961,
                                      215372562,
                                      215279904,
                                      215579026,
                                      215323522,
                                      215323522,
                                      215462701,
                                      214789503,
                                      215246009,
                                      215624861,
                                      214364403,
                                      215277099,
                                      215354298,
                                      215239801,
                                      215328210,
                                      215239801,
                                      215361544,
                                      215644006,
                                      215131903,
                                      215265301,
                                      214898122,
                                      215581602,
                                      214898122,
                                      215581602,
                                      215482881,
                                      215499819,
                                      215012493,
                                      215366507,
                                      215413617,
                                      215366507,
                                      214867965,
                                      215367639,
                                      215528168,
                                      215366507,
                                      214927368,
                                      215647021,
                                      215671347,
                                      215405987,
                                      215326965,
                                      215489899,
                                      215489899,
                                      215625725,
                                      215364891,
                                      215372088,
                                      215650961,
                                      215010609,
                                      215010609,
                                      215128747,
                                      215439318,
                                      215685172,
                                      215302742,
                                      215128747,
                                      215302742,
                                      215454383,
                                      215439318,
                                      215598575,
                                      215234703,
                                      215482881,
                                      215527591,
                                      215604563,
                                      215499380,
                                      215527591,
                                      215453131,
                                      215111529,
                                      215367906,
                                      215411880,
                                      215444216,
                                      215270950,
                                      215411880,
                                      215292611,
                                      215459397,
                                      215584052,
                                      215439041,
                                      215439041,
                                      215369861,
                                      215324984,
                                      215624861,
                                      215088794,
                                      215248825,
                                      214773918,
                                      215482320,
                                      215123018,
                                      215582548,
                                      215246009,
                                      215342132,
                                      215246009,
                                      215457530,
                                      215611193,
                                      215342132,
                                      215531234,
                                      214785426,
                                      215582600,
                                      215531234,
                                      214785426,
                                      215582600,
                                      215244940,
                                      215494595,
                                      215248242,
                                      215494595,
                                      215551364,
                                      215415374,
                                      215204114,
                                      215012060,
                                      214906411,
                                      215369861,
                                      215306017,
                                      215307034,
                                      215348778,
                                      215479014,
                                      215528968,
                                      215101606,
                                      214826351,
                                      215449115,
                                      215479014,
                                      215612002,
                                      215413088,
                                      215343403,
                                      215611193,
                                      215323589,
                                      215361193,
                                      214932948,
                                      215361193,
                                      215323036,
                                      215526382,
                                      215373443,
                                      215518612,
                                      215373443,
                                      215373443,
                                      215265867,
                                      215265867,
                                      215669107,
                                      214398515,
                                      214398515,
                                      215648302,
                                      215413443,
                                      215368217,
                                      215537339,
                                      215413443,
                                      215123018,
                                      215625406,
                                      215611193,
                                      215445390,
                                      215482320,
                                      214906411,
                                      215669121,
                                      215584052,
                                      215500247,
                                      215413443,
                                      215279904,
                                      215500247,
                                      215500247,
                                      215615356,
                                      214932948,
                                      215372088,
                                      215615356,
                                      215650698,
                                      215270338,
                                      215615356,
                                      215266601,
                                      215114518,
                                      215235710,
                                      215612872,
                                      215265497,
                                      215370594,
                                      215111529,
                                      215494595,
                                      214560050,
                                      215623354,
                                      214232331,
                                      215312538,
                                      215517976,
                                      215669894,
                                      215712386,
                                      215388071,
                                      215712386,
                                      215312538,
                                      215650698,
                                      214943916,
                                      214232331,
                                      215460326,
                                      215669107,
                                      215583160,
                                      215582142,
                                      215356429,
                                      215356429,
                                      214289611,
                                      214289611,
                                      215270976,
                                      215270976,
                                      215646558,
                                      215537339,
                                      215605644,
                                      215434422,
                                      215480956,
                                      215619836,
                                      215619836,
                                      215480956,
                                      215646284,
                                      215712386,
                                      215067359,
                                      215525826,
                                      214730270,
                                      215323522,
                                      215067359,
                                      215581008,
                                      215520539,
                                      215581008,
                                      214991794,
                                      214991794,
                                      215433395,
                                      215193217,
                                      215269751,
                                      215227321,
                                      215227321,
                                      215648302,
                                      215265301,
                                      215578013,
                                      215005684,
                                      215418956,
                                      215578013,
                                      215664614,
                                      215350923,
                                      215300228,
                                      215310194,
                                      215386569,
                                      215373099,
                                      215548904,
                                      215548904,
                                      215605644,
                                      215605644,
                                      215618590,
                                      215528236,
                                      215548904,
                                      215210180,
                                      215494399,
                                      215113325,
                                      215612872,
                                      214856716,
                                      215698224,
                                      215598989,
                                      215460326,
                                      214856716,
                                      215475538,
                                      215460326,
                                      215462701,
                                      215531234,
                                      215462701,
                                      215612744,
                                      215612744,
                                      215564496,
                                      214498033,
                                      215325244,
                                      215191016,
                                      215662308,
                                      215325244,
                                      215325111,
                                      215325244,
                                      215264058,
                                      215248825,
                                      215406538,
                                      215481657,
                                      215248825,
                                      215364891,
                                      215328210,
                                      215277179,
                                      215646284,
                                      215612002,
                                      215652299,
                                      215612002,
                                      215652299,
                                      215012493,
                                      215129114,
                                      215239801,
                                      215016375,
                                      215191016,
                                      215516796,
                                      215503888,
                                      215202777,
                                      215646558,
                                      215251120,
                                      215251120,
                                      214867845,
                                      215460399,
                                      215460399,
                                      215239008,
                                      215338952,
                                      214785380,
                                      215391796,
                                      214785380,
                                      215346972,
                                      215391796,
                                      214597669,
                                      215235696,
                                      215113325,
                                      215311507,
                                      215415374,
                                      215407675,
                                      215601047,
                                      214603837,
                                      215372088,
                                      215521688,
                                      214603837,
                                      214398515,
                                      215204114,
                                      214167559,
                                      215604563,
                                      215235696,
                                      215445452,
                                      215298223,
                                      215583488,
                                      215323589,
                                      215528236,
                                      215460399,
                                      215298223,
                                      215400417,
                                      215400417,
                                      215581788,
                                      215203116,
                                      215088794,
                                      214943916,
                                      215277099,
                                      214895799,
                                      214895799,
                                      215011065,
                                      214603837,
                                      215406252,
                                      215039736,
                                      214904656,
                                      214927368,
                                      215526627,
                                      215476329,
                                      215107109,
                                      215193217,
                                      215193217,
                                      215716169,
                                      215475538,
                                      215626015,
                                      215107109,
                                      215401868,
                                      215401868,
                                      215464116,
                                      215464116,
                                      215464116,
                                      215464116,
                                      215265867,
                                      214931169,
                                      215444216,
                                      215434422,
                                      215234703,
                                      215150021,
                                      215569774,
                                      215457530,
                                      214781198,
                                      215234703,
                                      215710847,
                                      214781198,
                                      215355544,
                                      215624861,
                                      215114518,
                                      215264224,
                                      215207414,
                                      215529170,
                                      215369861,
                                      215113191,
                                      215010396,
                                      215698224,
                                      215367906,
                                      215406252,
                                      214498033,
                                      215655056,
                                      215367337,
                                      215462529,
                                      215571596,
                                      215367337,
                                      215317201,
                                      215322930,
                                      214397991,
                                      215433395,
                                      215491737,
                                      214232331,
                                      215433395,
                                      215668720,
                                      214531173,
                                      214562458,
                                      215328070,
                                      215184680,
                                      215555497,
                                      215503888,
                                      213826266,
                                      215306017,
                                      215235710,
                                      213826266,
                                      215343403,
                                      215623499,
                                      215012060,
                                      215668720,
                                      215388071,
                                      214857679,
                                      215350923,
                                      214857679,
                                      215579026,
                                      215114571,
                                      215162719,
                                      215114571,
                                      215555497,
                                      215259555,
                                      215244304,
                                      215162316,
                                      215003355,
                                      215259555,
                                      215605644,
                                      215598248,
                                      214854664,
                                      215714013,
                                      214531173,
                                      215714013,
                                      215300228,
                                      215355544,
                                      214931169,
                                      215264224,
                                      215317201,
                                      215241594,
                                      215525826,
                                      215582809,
                                      215039736,
                                      215210180,
                                      215366170,
                                      215305893,
                                      215618590,
                                      215320708,
                                      215437712,
                                      215402157,
                                      215445409,
                                      215698224,
                                      215648355,
                                      215247995,
                                      214418856,
                                      215348397,
                                      215239801,
                                      215366463,
                                      215518612,
                                      215551364,
                                      215348397,
                                      215385649,
                                      215292611,
                                      215385649,
                                      215202777,
                                      215096677,
                                      215202777,
                                      215663907,
                                      215369102,
                                      215386569,
                                      215096677,
                                      215265715,
                                      215404344,
                                      214562444,
                                      214397991,
                                      215264170,
                                      214867845,
                                      215713985,
                                      215264170,
                                      215459397,
                                      215459397,
                                      215402157,
                                      215003355,
                                      215685172,
                                      215111595,
                                      215710627,
                                      215482881,
                                      215111595,
                                      215247995,
                                      215618590,
                                      215476329,
                                      215491708,
                                      215437712,
                                      215292611,
                                      215664614,
                                      215249875,
                                      215521688,
                                      215362508,
                                      215404344,
                                      215277179,
                                      215270740,
                                      214919231,
                                      215270740,
                                      214553682,
                                      215366463,
                                      214563355,
                                      215308871,
                                      215644006,
                                      215308871,
                                      215411568,
                                      214597669,
                                      214397991,
                                      215346972,
                                      215409992,
                                      215411568,
                                      215326484,
                                      215493691,
                                      215525126,
                                      215708573,
                                      214904674,
                                      215185319,
                                      215641094,
                                      215185319,
                                      214789170,
                                      215232586,
                                      215583160,
                                      215493691,
                                      213922928,
                                      214553682,
                                      215641094,
                                      215138042,
                                      215185319,
                                      214167559,
                                      215612744,
                                      214902604,
                                      215223327,
                                      214418856,
                                      215352347,
                                      215525126,
                                      215339280,
                                      215528168,
                                      215352347,
                                      215460326,
                                      215413923,
                                      215601047,
                                      215355654,
                                      215564496,
                                      215457530,
                                      215112969,
                                      215033893,
                                      215666909,
                                      215368217,
                                      215623499,
                                      215207414,
                                      215713985,
                                      215598248,
                                      215369102,
                                      215623499,
                                      215569135,
                                      215569135,
                                      214789492,
                                      215710847,
                                      215623354,
                                      215014619,
                                      215322258,
                                      215112969,
                                      215339280,
                                      215355544,
                                      215449115,
                                      215343403,
                                      214744335,
                                      214776820,
                                      215184098,
                                      215162316,
                                      215707564,
                                      214751317,
                                      215106778,
                                      215708573,
                                      215576363,
                                      215265497,
                                      215184098,
                                      215584052,
                                      215655056,
                                      215695306,
                                      215695642,
                                      215413923,
                                      215695642,
                                      215326484,
                                      215317201,
                                      215244304,
                                      215661056,
                                      215406827,
                                      215266353,
                                      215462529,
                                      215647021,
                                      215491708,
                                      215497137,
                                      215238726,
                                      214232331,
                                      215249187,
                                      214789170,
                                      215386569,
                                      215223157,
                                      214144683,
                                      215497137,
                                      215238726,
                                      215619860,
                                      215581656,
                                      215014619,
                                      215223157,
                                      215494399,
                                      215518110,
                                      215499819,
                                      215362508,
                                      215716169,
                                      215264058,
                                      215016375,
                                      214776820,
                                      215581656,
                                      214919231,
                                      215668720,
                                      213922928,
                                      215483633,
                                      215262074,
                                      215322930,
                                      215581656,
                                      215209617,
                                      215666909,
                                      214860474,
                                      214783597,
                                      215706672,
                                      215483633,
                                      215184680,
                                      215601047,
                                      215584052,
                                      214902604,
                                      215150021,
                                      215162316,
                                      215346972,
                                      214860474,
                                      215266353,
                                      215209617,
                                      214789492,
                                      215409992,
                                      214902604,
                                      215241594,
                                      215576363,
                                      215010396,
                                      215619860,
                                      215558088,
                                      214904674,
                                      214789503,
                                      215162608,
                                      214144683,
                                      215696119,
                                      215355654,
                                      215696119,
                                      215010396,
                                      214904656,
                                      215005684,
                                      215710627,
                                      215162608,
                                      215706672,
                                      215494399,
                                      215368217,
                                      215262074,
                                      215520539,
                                      214854664,
                                      215710627,
                                      215455154,
                                      214854664,
                                      215583654,
                                      215005684,
                                      215712386,
                                      215406538,
                                      215499836,
                                      215322930,
                                      214993875,
                                      214730270,
                                      215696119,
                                      214993875,
                                      215312538,
                                      215129114,
                                      215113191,
                                      215249187,
                                      215138042,
                                      214919231,
                                      215455154,
                                      215131354,
                                      215517976,
                                      215706672))
       and a.difecodi is not null;

Begin

  for rg in cuDiferidos loop
    begin
      insert into "OPEN".cc_grace_peri_defe
        (GRACE_PERI_DEFE_ID,
         GRACE_PERIOD_ID,
         DEFERRED_ID,
         INITIAL_DATE,
         END_DATE,
         PROGRAM,
         PERSON_ID)
      values
        ("OPEN".seq_cc_grace_peri_d_185489.nextval,
         46, -- Codigo del perido de gracia
         rg.diferido, -- Codigo del diferido
         sysdate,
         sysdate + 30, -- Fecha actual + 30 dias
         20, -- Programa "Customer"
         39892); -- Persona "Brillaapp"
    
      dbms_output.put_line('Se genero periodo de gracia al diferido ' ||
                           rg.diferido);
      commit;
    
    exception
      when no_data_found then
        rollback;
        dbms_output.put_line('Error - No se genero periodo de gracia al diferido ' ||
                             rg.diferido || ' - ' || sqlerrm);
    end;
  end loop;

  commit;

  -- End proceso del saldo a favor cupon 232964998

exception
  when others then
    rollback;
    dbms_output.put_line('Error: ' || sqlerrm);
end;
/

select to_char(sysdate,'yyyy-mm-dd hh:mi:ss p.m.') fecha_fin from dual;
set serveroutput off
quit
/