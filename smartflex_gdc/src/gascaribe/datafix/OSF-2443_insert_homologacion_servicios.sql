BEGIN

MERGE INTO PERSONALIZACIONES.HOMOLOGACION_SERVICIOS A USING
 (SELECT
  'OPEN' AS ESQUEMA_ORIGEN,
  UPPER('LDC_FNCRETORNAMARCAPROD') AS SERVICIO_ORIGEN,
  'OBTIENE LA MARCA DE TIPO DE SUSPENSION DE UN PRODUCTO' AS DESCRIPCION_ORIGEN,
  'ADM_PERSON' AS ESQUEMA_DESTINO,
  UPPER('PKG_LDC_MARCA_PRODUCTO.FNUOBTIENEMARCAPRODUCTO') AS SERVICIO_DESTINO,
  'OBTIENE LA MARCA DE TIPO DE SUSPENSION DE UN PRODUCTO' AS DESCRIPCION_DESTINO,
  NULL AS OBSERVACION
  FROM DUAL) B
ON (A.ESQUEMA_ORIGEN = B.ESQUEMA_ORIGEN AND A.SERVICIO_ORIGEN = B.SERVICIO_ORIGEN AND A.ESQUEMA_DESTINO = B.ESQUEMA_DESTINO)
WHEN NOT MATCHED THEN 
INSERT (
  ESQUEMA_ORIGEN, SERVICIO_ORIGEN, DESCRIPCION_ORIGEN, ESQUEMA_DESTINO, SERVICIO_DESTINO, 
  DESCRIPCION_DESTINO, OBSERVACION)
VALUES (
  B.ESQUEMA_ORIGEN, B.SERVICIO_ORIGEN, B.DESCRIPCION_ORIGEN, B.ESQUEMA_DESTINO, B.SERVICIO_DESTINO, 
  B.DESCRIPCION_DESTINO, B.OBSERVACION)
WHEN MATCHED THEN
UPDATE SET 
  A.DESCRIPCION_ORIGEN = B.DESCRIPCION_ORIGEN,
  A.SERVICIO_DESTINO = B.SERVICIO_DESTINO,
  A.DESCRIPCION_DESTINO = B.DESCRIPCION_DESTINO,
  A.OBSERVACION = B.OBSERVACION;

COMMIT;

END;
/