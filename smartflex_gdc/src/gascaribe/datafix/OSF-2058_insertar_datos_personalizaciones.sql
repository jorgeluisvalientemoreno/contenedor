DECLARE 
	CURSOR cuExisteTabla IS
		SELECT 	COUNT(1)
		FROM 	dba_tables
		WHERE 	owner = 'PERSONALIZACIONES'
		AND 	table_name = 'MASTER_PERSONALIZACIONES';
		
    nuExiste 	NUMBER;
BEGIN
	
	INSERT INTO MASTER_PERSONALIZACIONES(esquema, nombre, tipo_objeto)
		SELECT  OWNER, OBJECT_NAME, OBJECT_TYPE
		FROM    ALL_OBJECTS
		WHERE   OWNER IN ('OPEN')
		AND     OBJECT_TYPE NOT IN ('SYNONYM', 'INDEX', 'PACKAGE BODY', 'SEQUENCE', 'TYPE', 'JAVA CLASS', 'JAVA RESOURCE', 'SCHEDULE', 'JAVA SOURCE', 'QUEUE', 'LOB')
		AND     NOT EXISTS (SELECT 'X' FROM MASTER_OPEN WHERE MASTER_OPEN.NOMBRE = ALL_OBJECTS.OBJECT_NAME AND MASTER_OPEN.OBJECT_TYPE = ALL_OBJECTS.OBJECT_TYPE)
		AND     NOT EXISTS (SELECT 'X' FROM GR_CONFIG_EXPRESSION WHERE GR_CONFIG_EXPRESSION.OBJECT_NAME = ALL_OBJECTS.OBJECT_NAME)
		AND     NOT EXISTS (SELECT 'X' FROM GE_ENTITY WHERE GE_ENTITY.NAME_ = ALL_OBJECTS.OBJECT_NAME)
        AND     NOT EXISTS (SELECT 'X' FROM MASTER_PERSONALIZACIONES WHERE OWNER = ESQUEMA AND OBJECT_NAME = NOMBRE AND OBJECT_TYPE = TIPO_OBJETO)
		AND     NOT EXISTS (SELECT 'X' FROM GE_OBJECT WHERE GE_OBJECT.NAME_ LIKE ALL_OBJECTS.OBJECT_NAME||'%');
	
	COMMIT;
	
END;
/