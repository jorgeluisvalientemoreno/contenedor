DECLARE
	CURSOR CUREPETIDOS IS
	SELECT ACTIVIDAD_PADRE, ACTIVIDAD_HIJA, COUNT(1)
FROM LDC_ACT_FATHER_ACT_HIJA
GROUP BY ACTIVIDAD_PADRE, ACTIVIDAD_HIJA
HAVING COUNT(1)>1;

BEGIN
	FOR REG IN CUREPETIDOS LOOP
		BEGIN
			DELETE LDC_ACT_FATHER_ACT_HIJA A WHERE A.ACTIVIDAD_PADRE=REG.ACTIVIDAD_PADRE AND A.ACTIVIDAD_HIJA=REG.ACTIVIDAD_HIJA AND ROWNUM=1;
			COMMIT;
		EXCEPTION
			WHEN OTHERS THEN
			ROLLBACK;
		END;
	END LOOP;
END;
/