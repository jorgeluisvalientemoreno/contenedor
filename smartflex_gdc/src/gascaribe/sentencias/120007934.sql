update ge_statement
   set module_id    = 4,
       description  = 'LDC_CONST_REDES_EXTERNAS',
       statement    = q'#SELECT ldc_boutilities.fsbgetvalorcampotabla('SISTEMA',
                                              'SISTCODI',
                                              'SISTEMPR',
                                              99) EMPRESA,
   ldc_boutilities.fsbgetvalorcampotabla('SISTEMA',
                                              'SISTCODI',
                                              'SISTNITC',
                                              99) NIT_EMPRESA,
   O.ORDER_ID NO_ORDEN_TRAB,
   O.OPERATING_UNIT_ID||'-'||U.NAME UNIDAD_TRABAJO,
   O.TASK_TYPE_ID||'-'||T.DESCRIPTION TIPO_TRAB,
   T.TASK_TYPE_CLASSIF||'-'||
   open.LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('GE_TASK_CLASS','TASK_CLASS_ID','DESCRIPTION',T.TASK_TYPE_CLASSIF) CLASIFICACION,
   O.OPERATING_SECTOR_ID||'-'||OS.DESCRIPTION SECTOR_OPERATIVO,
   O.CREATED_DATE FECHA_CREACION,
   O.ASSIGNED_DATE FECHA_ASIGNACION,
   o.max_date_to_legalize fecha_max_legalizacion,
   U.CONTRACTOR_ID||'-'||
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('GE_CONTRATISTA','ID_CONTRATISTA','NOMBRE_CONTRATISTA',U.CONTRACTOR_ID) CONTRATISTA,
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('AB_ADDRESS','ADDRESS_ID','ADDRESS',
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('OR_ORDER_ACTIVITY','ORDER_ID','ADDRESS_ID',o.order_id)) DIRECCION,
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('ab_address','address_id','geograp_location_id',o.external_address_id)||'-'||
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('GE_GEOGRA_LOCATION','GEOGRAP_LOCATION_ID','DESCRIPTION',
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('ab_address','address_id','geograp_location_id',o.external_address_id)) LOCALIDAD,
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('GE_GEOGRA_LOCATION','GEOGRAP_LOCATION_ID','GEO_LOCA_FATHER_ID',
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('ab_address','address_id','geograp_location_id',o.external_address_id))||'-'||
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('GE_GEOGRA_LOCATION','GEOGRAP_LOCATION_ID','DESCRIPTION',
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('GE_GEOGRA_LOCATION','GEOGRAP_LOCATION_ID','GEO_LOCA_FATHER_ID',
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('ab_address','address_id','geograp_location_id',o.external_address_id))) DEPARTAMENTO,
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('GE_GEOGRA_LOCATION','GEOGRAP_LOCATION_ID','GEOGRAP_LOCATION_ID',
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('AB_ADDRESS','ADDRESS_ID','NEIGHBORTHOOD_ID',o.external_address_id))||'-'||
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('GE_GEOGRA_LOCATION','GEOGRAP_LOCATION_ID','DESCRIPTION',
   LDC_BOUTILITIES.FSBGETVALORCAMPOTABLA('AB_ADDRESS','ADDRESS_ID','NEIGHBORTHOOD_ID',o.external_address_id))BARRIO,
   REGEXP_REPLACE(UPPER(oa.comment_), '[^A-Za-z0-9ÁÉÍÓÚáéíóú()-_ ]', '') OBSERVACION,
   LDC_RETORNACOMENTOTLEGA(O.ORDER_ID) COMENTARIO,
   ldc_fsbobtordhija(oa.order_activity_id) ORD_GENERADA,
   oa.order_activity_id
FROM OR_ORDER O, OR_OPERATING_UNIT U, OR_TASK_TYPE T, OR_OPERATING_SECTOR OS, or_order_activity oa
WHERE O.OPERATING_UNIT_ID        = U.OPERATING_UNIT_ID
AND O.TASK_TYPE_ID               = T.TASK_TYPE_ID
AND O.OPERATING_SECTOR_ID        = OS.OPERATING_SECTOR_ID
AND oa.ORDER_ID                  = o.ORDER_ID
AND O.ORDER_ID                   = :ORDER_ID#',
       name='LDC_NOTI_CONST_REDES_EXTERNAS'
 where statement_id = 120007934;
 commit;
