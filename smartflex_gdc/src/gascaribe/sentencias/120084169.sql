update ge_statement
   set module_id    = 48,
       description  = 'LDC_FORM_SUS_RECO_PERS_GDC',
       statement    = q'#SELECT PKTBLSISTEMA.FSBGETCOMPANYNAME(99) NOMBRE_EMPRESA,
 PKTBLSISTEMA.FSBGETSISTNITC(99) NIT,
 SUBSTR(LDC_CA_NOTI.FSBSECTOROPERATIVO(O.OPERATING_SECTOR_ID),0,32) SECTOR_OPERATIVO,
 O.ORDER_ID NUMERO_ORDEN,
 LDC_CA_NOTI.FSBUNIDADOPERATIVA(O.OPERATING_UNIT_ID) UNIDAD_OPERATIVA,
 (select SESUNUSE from SERVSUSC where SESUSUSC = OA.SUBSCRIPTION_ID AND SESUSERV = 7014) PRODUCTO,
 Upper(LDC_CA_NOTI.FSBTIPOTRAB(OA.TASK_TYPE_ID))  TIPO_TRABAJO,
 O.CREATED_DATE   FECHA_GENERACION_OT,
 LDC_CA_NOTI.FSBACTTIPOTRAB(OA.ACTIVITY_ID) ACTIVIDAD_TIPO_TRABAJO,
 TO_CHAR(O.ASSIGNED_DATE,'DD-MM-YYYY') FECHA_ASIGNACION_OT,
 LDC_CA_NOTI.FSBMETODOSUSPENCION(OA.PRODUCT_ID) METODO_SUSPENCION,
 LDC_CA_NOTI.FNUCONTRATO(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID) NUMERO_CONTRATO,
 LDC_CA_NOTI.FSBTIPOCLIE(OA.SUBSCRIBER_ID) TIPO_CLIENTE,
 SUBSTR(LDC_CA_NOTI.FNUNOMBRE(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID),0,32) NOMBRE_CLIENTE,
 LDC_CA_NOTI.FSBTIPOPRED(OA.SUBSCRIPTION_ID) TIPO_PREDIO,
 DAAB_ADDRESS.FSBGETADDRESS(OA.ADDRESS_ID) DIRECCION_PREDIO,
 SUBSTR(LDC_CA_NOTI.FSBCICLO(OA.SUBSCRIPTION_ID),0,32) CICLO,
 SUBSTR(LDC_CA_NOTI.FSBCATE(OA.SUBSCRIPTION_ID),0,32) CATEGORIA,
 DAAB_ADDRESS.FNUGETGEOGRAP_LOCATION_ID(OA.ADDRESS_ID,NULL)||'-'||
 SUBSTR(DAGE_GEOGRA_LOCATION.FSBGETDESCRIPTION(DAAB_ADDRESS.FNUGETGEOGRAP_LOCATION_ID(OA.ADDRESS_ID,NULL),NULL),0,28) LOCALIDAD,
 LDC_CA_NOTI.FSBSUBCATE(OA.SUBSCRIPTION_ID) SUBCATEGORIA,
 LDC_CA_NOTI.FSBNUMMEDIDOR(OA.SUBSCRIPTION_ID) NUMERO_DEL_MEDIDOR,
 LDC_CA_NOTI.FSBREFECATAST(OA.SUBSCRIPTION_ID) REFERENCIA_CATASTRAL,
 LDC_CA_NOTI.FSBESTADOMEDIDOR(OA.SUBSCRIPTION_ID) ESTADO_DEL_MEDIDOR,
 LDC_CA_NOTI.FSBEDADDEUDA(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID) EDAD_DEUDA,
 LDC_CA_NOTI.FSBRUTALECTURA(OA.SUBSCRIPTION_ID) RUTA_LECTURA,
 LDC_CA_NOTI.FSBPLACARASIG(O.ORDER_ID) PLAN_CARTERA_ASIGNADO,
 LDC_CA_NOTI.FSBULTLECTTOMA(OA.SUBSCRIPTION_ID) ULTIMA_LECTURA_TOMADA,
 LDC_CA_NOTI.FSBNUMREFINA(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID) NUMERO_REFINANCIACIONES,
 LDC_CA_NOTI.FNUVALSALDOPENTOT(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID) VALOR_SALDO_PENDIENTE,
 LDC_CA_NOTI.FSBFECHULTIREFI(OA.SUBSCRIPTION_ID) FECHA_ULTIMA_REFINANCIACION,
  LDC_CA_NOTI.FNUVALSALDOPEN(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID) SALDO_ANTERIOR,
 (SELECT DALD_PARAMETER.FNUGETNUMERIC_VALUE('VALOR_REC_ACOMETIDA') FROM DUAL) TARIFA_CONCEPTO_REC_ACOMETIDA,
 (SELECT DALD_PARAMETER.FNUGETNUMERIC_VALUE('VALOR_REC_CENTRO_MED') FROM DUAL) TARIFA_CONCEPTO_REC_CM,
 LDC_CA_NOTI.FSBSALDODIFER(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID) VALOR_SALDO_DIFERIDO,
 LDC_CA_NOTI.FNUNUCUENSALDO(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID)NUMERO_CUENTAS_CON_SALDO,
 OA.PACKAGE_ID NUMERO_SOLICITUD,
(SELECT MM.REQUEST_DATE FROM MO_PACKAGES MM WHERE MM.PACKAGE_ID = OA.PACKAGE_ID) FECHA_SOLICITUD,
LDC_CA_NOTI.FSBESTCORTSERVICIO(LDC_CA_NOTI.FNUCONTRATO(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID)) ESTADO_CORTE,
GC_BODEBTMANAGEMENT.FNUGETEXPIRDEBTBYPROD(OA.PRODUCT_ID) SALDO_VENCIDO_PRODCUTO,
GC_BODEBTMANAGEMENT.FNUGETDEBTBYPROD(OA.PRODUCT_ID) SALDO_PENDIENTE_PRODUCTO,
GC_BODEBTMANAGEMENT.FNUGETDEBTBYSUSC(LDC_CA_NOTI.FNUCONTRATO(OA.SUBSCRIBER_ID,OA.SUBSCRIPTION_ID,OA.PRODUCT_ID)) SALDO_PENDIENTE_CONTRATO,
DALD_PARAMETER.FSBGETVALUE_CHAIN('NOTIF_LINEA_ATENCION_GASERA') NOTA_LINEA_ATENCION_GASERA,
LD_BOLASTSUSPENSIONDATA.FSBULTLECORDSUSPENSION(OA.PRODUCT_ID) LECTSUSP,
(select SESUESFN from SERVSUSC where SESUNUSE = OA.PRODUCT_ID) ESTADO_FINANCIERO,
(select PRPCSACA from gc_prodprca where PRPCNUSE = OA.PRODUCT_ID) VALOR_CASTIGADO
FROM OR_ORDER O,
     OR_ORDER_ACTIVITY OA
WHERE O.ORDER_ID = OA.ORDER_ID
  AND O.ORDER_ID = :ORDER_ID#',
       name='LDC_FORM_SUS_RECO_PERS_GDC'
 where statement_id = 120084169;
 commit;
