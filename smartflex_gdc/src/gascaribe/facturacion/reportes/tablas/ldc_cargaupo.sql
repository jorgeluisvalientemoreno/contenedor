DECLARE
  nuconta number;
BEGIN
  SELECT COUNT(1) INTO nuconta
  FROM DBA_TABLES
  WHERE TABLE_NAME = 'LDC_CARGAUPO';
  
  IF nuconta = 0 THEN  
	EXECUTE IMMEDIATE 'CREATE TABLE LDC_CARGAUPO(  ANIO 			NUMBER(4),
												   MES              NUMBER(2),
												   CICLO            NUMBER(4),
												   CUENTA           NUMBER(10),
												   PRODUCTO         NUMBER(10),
												   CONTRATO         NUMBER(10),
												   TIPO_PRODUCTO    NUMBER(4),
												   CONCEPTO         NUMBER(4),
												   FECHA_CARGO      DATE,
												   VALOR            NUMBER(13,2),
												   DOCUSOPE         VARCHAR2(30),
												   SIGNO            VARCHAR2(2),
												   CATEGORIA        NUMBER(2),
												   SUBCATEGORIA     NUMBER(2),
												   CAUSCARG         NUMBER(2),
												   ESTADO_PRODUCTO  NUMBER(4),
												   ESTADO_CORTE     NUMBER(3),
												   UNIDADES         NUMBER(15,4),
												   PROGRAMA         NUMBER(4),
												   DEPARTAMENTO     NUMBER(4),
												   TARIFA_FIJA      NUMBER(15,4),
												   TARIFA_VARIABLE  NUMBER(15,4),
												   IDENJOB			NUMBER(10))';
	EXECUTE IMMEDIATE 'CREATE INDEX IDXCON_CARGAUPO ON LDC_CARGAUPO(ANIO, MES, CICLO, DEPARTAMENTO)';
	EXECUTE IMMEDIATE 'CREATE INDEX IDXCON01_CARGAUPO ON LDC_CARGAUPO(ANIO, MES, CICLO)';
	EXECUTE IMMEDIATE 'CREATE INDEX IDXCON02_CARGAUPO ON LDC_CARGAUPO(DEPARTAMENTO)';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.ANIO            IS ''ANIO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.MES             IS ''MES''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.CICLO           IS ''CICLO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.CUENTA          IS ''CUENTA''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.PRODUCTO        IS ''PRODUCTO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.CONTRATO        IS ''CONTRATO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.TIPO_PRODUCTO   IS ''TIPO DE PRODUCTO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.CONCEPTO        IS ''CONCEPTO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.FECHA_CARGO     IS ''FECHA DE CARGO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.VALOR           IS ''VALOR''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.DOCUSOPE        IS ''DOCUMENTO DE SOPORTE''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.SIGNO           IS ''SIGNO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.CATEGORIA       IS ''CATEGORIA''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.SUBCATEGORIA    IS ''SUBCATEGORIA''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.CAUSCARG    IS ''CAUSAL DE CARGO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.ESTADO_PRODUCTO IS ''ESTADO DE PRODUCTO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.ESTADO_CORTE    IS ''ESTADO DE CORTE''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.UNIDADES        IS ''UNIDADES''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.PROGRAMA        IS ''PROGRAMA''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.DEPARTAMENTO    IS ''DEPARTAMENTO''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.TARIFA_FIJA     IS ''TARIFA FIJA''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.TARIFA_VARIABLE IS ''TARIFA VARIABLE''';
	EXECUTE IMMEDIATE 'COMMENT ON COLUMN LDC_CARGAUPO.IDENJOB IS ''ID JOB''';
	EXECUTE IMMEDIATE 'COMMENT ON TABLE LDC_CARGAUPO IS ''CARGOS A LA -1 DE AUDITORIA POSTERIORES''';
	
  ELSE	

	EXECUTE IMMEDIATE 'ALTER TABLE LDC_CARGAUPO ADD IDENJOB NUMBER(10)';  
	EXECUTE IMMEDIATE 'CREATE INDEX IDX_CON04CARGAUPO ON LDC_CARGAUPO(IDENJOB, DEPARTAMENTO)'
	
  END IF;
  
  EXECUTE immediate 'grant select, insert, delete, update on LDC_CARGAUPO to SYSTEM_OBJ_PRIVS_ROLE';
  EXECUTE immediate 'grant select, insert, delete, update on LDC_CARGAUPO to robebrcon';
  execute immediate 'grant select on LDC_CARGAUPO to RSELOPEN';
  execute immediate 'grant select on LDC_CARGAUPO to reportes';
	

END;
/