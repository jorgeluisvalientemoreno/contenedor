CREATE OR REPLACE TRIGGER ADM_PERSON.LDC_TRG_GE_DISTRIBUTION_FILE
AFTER DELETE OR INSERT ON OPEN.GE_DISTRIBUTION_FILE
FOR EACH ROW
BEGIN
  IF INSERTING THEN
    BEGIN
      EXECUTE IMMEDIATE 'INSERT INTO OPEN.GE_DISTRIBUTION_FILE_BASE VALUES ('''||:NEW.DISTRIBUTION_FILE_ID||''','''||:NEW.DESCRIPTION||''','''||:NEW.FILE_VERSION||''','||:NEW.VERSION_NUMBER||','''||:NEW.FILE_NAME||''',NULL,'''||:NEW.MD5_HASH||''','||:NEW.DISTRI_GROUP_ID||',NULL)';
    EXCEPTION WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('ERROR:['||SQLERRM||']:INSERT INTO OPEN.GE_DISTRIBUTION_FILE_BASE VALUES ('''||:NEW.DISTRIBUTION_FILE_ID||''','''||:NEW.DESCRIPTION||''','''||:NEW.FILE_VERSION||''','||:NEW.VERSION_NUMBER||','''||:NEW.FILE_NAME||''',NULL,'''||:NEW.MD5_HASH||''','||:NEW.DISTRI_GROUP_ID||',NULL)');
    END;
  END IF;

  IF DELETING THEN
    BEGIN
      EXECUTE IMMEDIATE 'DELETE OPEN.GE_DISTRIBUTION_FILE_BASE WHERE DISTRIBUTION_FILE_ID = '''||:OLD.DISTRIBUTION_FILE_ID||'''';
    EXCEPTION WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('ERROR:['||SQLERRM||']:DELETE OPEN.GE_DISTRIBUTION_FILE_BASE WHERE DISTRIBUTION_FILE_ID = '''||:OLD.DISTRIBUTION_FILE_ID||'''');
    END;
  END IF;
END;
/
