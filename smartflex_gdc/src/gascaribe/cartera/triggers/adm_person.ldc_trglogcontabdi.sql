CREATE OR REPLACE TRIGGER ADM_PERSON.LDC_TRGLOGCONTABDI 
BEFORE DELETE OR INSERT OR UPDATE ON LDC_CONTABDI 
REFERENCING OLD AS OLD NEW AS NEW 
FOR EACH ROW 
DECLARE
  sbOperacion VARCHAR2(1);
BEGIN
  
  IF INSERTING THEN
     sbOperacion := 'I';
  ELSIF UPDATING THEN
     sbOperacion := 'U';
  ELSE
    sbOperacion := 'D';
  END IF;
  
  INSERT INTO LDC_CONTABDILOG
  (
    CONTACT,
    CONTOLD,
    FECHA,
    USUARIO,
    TERMINAL,
    OPERACION
  )
  VALUES
  (
    :NEW.CONTRATO,
    :OLD.CONTRATO,
    SYSDATE,
    USER,
    USERENV('TERMINAL'),
    sbOperacion
  );
EXCEPTION
  WHEN OTHERS THEN
     ERRORS.SETERROR;
     RAISE  ex.CONTROLLED_ERROR;
END;
/