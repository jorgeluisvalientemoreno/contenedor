BEGIN
	MERGE INTO PERSONALIZACIONES.PARAMETROS A USING
	 (SELECT
	  'DIREC_ARCH_CUPON_PEND_PAGO_1' as CODIGO,
	  'Directorio de los archivos de cupones pendientes de pago para BanColombia y Asobancaria' as DESCRIPCION,
	  NULL as VALOR_NUMERICO,
	  '/smartfiles/Recaudos/Envio' as VALOR_CADENA,
	  NULL as VALOR_FECHA,
	  6 as PROCESO,
	  TO_DATE('14/02/2024 15:47:39', 'DD/MM/YYYY HH24:MI:SS') as FECHA_CREACION,
	  NULL as FECHA_ACTUALIZACION,
	  'OPEN' as USUARIO,
	  'PMVM115' as TERMINAL
	  FROM DUAL) B
	ON (A.CODIGO = B.CODIGO)
	WHEN NOT MATCHED THEN 
	INSERT (
	  CODIGO, DESCRIPCION, VALOR_NUMERICO, VALOR_CADENA, VALOR_FECHA, 
	  PROCESO, FECHA_CREACION, FECHA_ACTUALIZACION, USUARIO, TERMINAL)
	VALUES (
	  B.CODIGO, B.DESCRIPCION, B.VALOR_NUMERICO, B.VALOR_CADENA, B.VALOR_FECHA, 
	  B.PROCESO, B.FECHA_CREACION, B.FECHA_ACTUALIZACION, B.USUARIO, B.TERMINAL)
	WHEN MATCHED THEN
	UPDATE SET 
	  A.DESCRIPCION = B.DESCRIPCION,
	  A.VALOR_NUMERICO = B.VALOR_NUMERICO,
	  A.VALOR_CADENA = B.VALOR_CADENA,
	  A.VALOR_FECHA = B.VALOR_FECHA,
	  A.PROCESO = B.PROCESO,
	  A.FECHA_CREACION = B.FECHA_CREACION,
	  A.FECHA_ACTUALIZACION = B.FECHA_ACTUALIZACION,
	  A.USUARIO = B.USUARIO,
	  A.TERMINAL = B.TERMINAL;

	COMMIT;
END;
/
